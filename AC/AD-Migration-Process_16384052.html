<!DOCTYPE html>
<html>
    <head>
        <title>Accman : AD Migration Process</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Accman</a></span>
                            </li>
                                                    <li>
                                <span><a href="Accman-Home_16384043.html">Accman Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Support-Notes_16384017.html">Support Notes</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Accman : AD Migration Process
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (uis894)</span> on Aug 21, 2013
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 id="ADMigrationProcess-Introduction">Introduction</h1><p>This process can be used when (for whatever reason) a student doesn't have an AD account. This process will read their Accman details and create a new account in AD for them, which will allow them to log into various systems.</p><h1 id="ADMigrationProcess-Process">Process</h1><ol><li>RDP onto uos-p-ambe-01.isdads.salford.ac.uk</li><li>Open command prompt</li><li>Change to AD Migration folder<ol><li>CD C:\accman\scripts\ADMigration</li></ol></li><li>Run Perl script to create a ad_student_migration.csv file<ol><li>perl ad_student_migration.pl</li></ol></li><li>Run Powershell script to update AD. Populates a folder (OU) called “Import” with user objects<ol><li>Powershell –file CreateUsersFromCSV.ps1</li><li>In “Import a CSV file” dialog box, select “ad_student_migration.csv”</li></ol></li></ol><ul><li>Note only creates user objects if they don’t already exist in the AD tree</li></ul><ol><li>writes a log file Filename-mmddyyhhmmss.log</li><li>Rename ad_student_migration.csv to ad_student_migration_YYYYMMDD.csv</li><li>Change to ConsoleSchedulerServiceAD folder<ol><li>CD C:\ConsoleSchedulerServiceAD</li></ol></li><li>Run Scheduler<ol><li>ConsoleSchedulerService.exe</li></ol></li><li>The next step is dependent on how you access the Accman Mail database. Basically transaction ID (trID) 1071077 in the transactions table needs to be updated from “processed” to “waiting”. After a minute or two this will be updated by the ConsoleSchedulerService above back to “processed”.</li><li>Back to uos-p-ambe-01.isdads.salford.ac.uk</li><li>Stop the ConsoleSchedulerService<ol><li>Type in “exit”</li></ol></li><li>Check the ConsoleSchedulerService logs<ol><li>Open text file C:\ConsoleSchedulerServiceAD\Logs\TransactionLogs\1071077.txt  and check for any problems.</li><li>Rename log file to 1071077_YYYYMMDD_HHMM.txt using the files modified date and time values.</li></ol></li><li>Move the user objects in the “Import” AD folder.<ol><li>Start “Active Directory Users and Computers”</li><li>Find the “Import” folder (OU)</li><li>Drag entries to the “Non Datacentre/Users/Students” folder (OU).</li></ol></li></ol>
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Mar 29, 2021 10:56</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
