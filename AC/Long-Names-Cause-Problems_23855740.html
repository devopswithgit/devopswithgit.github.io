<!DOCTYPE html>
<html>
    <head>
        <title>Accman : Long Names Cause Problems</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Accman</a></span>
                            </li>
                                                    <li>
                                <span><a href="Accman-Home_16384043.html">Accman Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="AccMan-Issues_19104073.html">AccMan Issues</a></span>
                            </li>
                                                    <li>
                                <span><a href="Review_19595581.html">Review</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Accman : Long Names Cause Problems
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (uis894)</span>, last modified by <span class='editor'> Paul Daniels</span> on Apr 15, 2016
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <div class='plugin-tabmeta-details'><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Summary</th><td class="confluenceTd">Long names cause problems, particularly for AD<br/> </td></tr><tr><th class="confluenceTh">Issue Type</th><td class="confluenceTd">Bug</td></tr><tr><th class="confluenceTh">Priority</th><td class="confluenceTd">High</td></tr><tr><th class="confluenceTh">Raised By</th><td class="confluenceTd"><a class="confluence-userlink user-mention" data-username="uis894" href="https://confluence.salford.ac.uk:8444/confluence/display/~uis894" data-linked-resource-id="655361" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://confluence.salford.ac.uk:8444/confluence">Unknown User (uis894)</a></td></tr><tr><th class="confluenceTh">Date Raised</th><td class="confluenceTd"><time datetime="2015-12-11" class="date-past">11 Dec 2015</time> </td></tr><tr><th class="confluenceTh">Source</th><td class="confluenceTd"><a class="confluence-userlink user-mention" data-username="aaa40096" href="https://confluence.salford.ac.uk:8444/confluence/display/~aaa40096" data-linked-resource-id="23203105" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://confluence.salford.ac.uk:8444/confluence">Unknown User (aaa40096)</a><br/> </td></tr><tr><th class="confluenceTh">JIRA Issue(s)</th><td class="confluenceTd">
<span class="jira-issue" data-jira-key="ARF-310" >
                    <a href="https://jira.salford.ac.uk:8443/jira/browse/ARF-310?src=confmacro" class="jira-issue-key"><img class="icon"
                                                                                      src="https://jira.salford.ac.uk:8443/jira/secure/viewavatar?size=xsmall&amp;avatarId=10303&amp;avatarType=issuetype"/>ARF-310</a>
                            -
            <span class="summary">Long Names Cause Problems</span>
                                                <span class="aui-lozenge aui-lozenge-subtle             aui-lozenge-default
     jira-macro-single-issue-export-pdf">Open</span>
                </span>
</td></tr></tbody></table></div></div><h2 id="LongNamesCauseProblems-Details">Details</h2><p>Very long names can prevent AD accounts from being created. The name fields are combined with the username field to form what will become the CN (Common-Name) in AD when executing a type-93 transaction.The CN in AD can not be longer than 64 characters.</p><p>For example, student PVP833 has the name &quot;<em>Isuru Hemasika Kumararsiri Hew Dewala Annakkage&quot;</em>. This in itself is 49 characters long. The final CN ends up being &quot;<em>Dewala Annakkage Isuru Hemasika Kumararsiri Hewa Kasakara IHKHK pvp833</em>&quot; and is built up in method <em>ActiveDirectoryBaseProcessor.setStandardAttributes</em>.</p><p>The exception commonly seen in the logs when this happens is:</p><p style="margin-left: 30.0px;"><em>Failed to save user in AD: at System.DirectoryServices.AccountManagement.ADStoreCtx.Insert(Principal p) </em><br/><em>at System.DirectoryServices.AccountManagement.Principal.Save() </em><br/><em>at Salford.AccMan.BackEnd.Processes.Processes.ActiveDirectoryBaseProcessor.saveUser(ADUserClassExtensions userExt) in C:\VS2010\CHG2212\Accman.NET\AccManBackEndLibrary\Processes\ActiveDirectoryBaseProcessor.cs:line 1643</em></p><p>Accman should be changed to prevent this from going over 64 characters <strong>but</strong> it must still be unique, so it should still have the username on the end.</p><p> </p><p>This is also affecting students that have more then 5 first names as the initial field on the person record is only 5 characters. This is affecting live@edu account generation and causing multiple person change records. This will in turn generate multiple Alma transactions and possibly Janus records.</p><h2 id="LongNamesCauseProblems-HowtoFix">How to Fix</h2><p>The temporary fix is to manually edit his PERSON record in the database so that his name is shorter. This should allow the AD transaction to be re-run (successfully this time) but of course the next time the Banner Import runs, the long version of his name will be put back into Accman. However it shouldn't matter by then because his AD account will have been created. </p><p>Here's the SQL to fix another account that just reported the problem (BTD063)</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: false; theme: Confluence" data-theme="Confluence">select * from person where personid = 3267478;
update person set initials = &#39;G&#39;, forenames = &#39;G G M Mudiyanselage Gayathri Kalhari&#39; where personid = 3267478 limit 1;</pre>
</div></div><p><span style="line-height: 1.42857;">Below is a log file from the successfully completed AD transaction for the above user. Note his CN is now short enough to go into AD.</span></p><div class="panel" style="border-width: 1px;"><div class="panelContent">
<div class="ui-dialog-content ui-widget-content"><h3 id="LongNamesCauseProblems-Logfilefortransaction:12658889">Log file for transaction: 12658889</h3>15/04/2016 10:57:09 - Transaction type is now ACTIVE_DIRECTORY_NEW_USER <br/>15/04/2016 10:57:09 - Trying to set configuration parameter adHost <br/>15/04/2016 10:57:09 - Trying to set configuration parameter adRoot <br/>15/04/2016 10:57:09 - Trying to set configuration parameter adConfigRoot <br/>15/04/2016 10:57:09 - Trying to set configuration parameter adStaffPath <br/>15/04/2016 10:57:09 - Trying to set configuration parameter adStudentPath <br/>15/04/2016 10:57:09 - Trying to set configuration parameter adFunctionalPath <br/>15/04/2016 10:57:09 - Trying to set configuration parameter adUnknownPath <br/>15/04/2016 10:57:09 - Trying to set configuration parameter adUsername <br/>15/04/2016 10:57:09 - Trying to set configuration parameter adPassword <br/>15/04/2016 10:57:09 - Trying to set configuration parameter adGroupsBase <br/>15/04/2016 10:57:09 - Trying to set configuration parameter adNonProvisionedGroupsBase <br/>15/04/2016 10:57:09 - Trying to set configuration parameter adFunctionalGroupsBase <br/>15/04/2016 10:57:09 - Trying to set configuration parameter studentHomeFolder1 <br/>15/04/2016 10:57:09 - Trying to set configuration parameter studentHomeFolder2 <br/>15/04/2016 10:57:09 - Trying to set configuration parameter studentHomeFolder3 <br/>15/04/2016 10:57:09 - Trying to set configuration parameter studentHomeFolder4 <br/>15/04/2016 10:57:09 - Trying to set configuration parameter studentHomeFolder5 <br/>15/04/2016 10:57:09 - Trying to set configuration parameter studentHomeFolder6 <br/>15/04/2016 10:57:09 - Trying to set configuration parameter staffHomeFolder1 <br/>15/04/2016 10:57:09 - Trying to set configuration parameter staffHomeFolder2 <br/>15/04/2016 10:57:09 - Trying to set configuration parameter emailDomain <br/>15/04/2016 10:57:09 - Trying to set configuration parameter principalDomain <br/>15/04/2016 10:57:09 - Trying to set configuration parameter exchangeUsername <br/>15/04/2016 10:57:09 - Trying to set configuration parameter exchangePassword <br/>15/04/2016 10:57:09 - Trying to set configuration parameter exchangeURI <br/>15/04/2016 10:57:09 - Trying to set configuration parameter exchangeSchemaURI <br/>15/04/2016 10:57:09 - Trying to set configuration parameter exchangeDatabases <br/>15/04/2016 10:57:09 - Trying to set configuration parameter skipSecurityChecks <br/>15/04/2016 10:57:09 - Trying to set configuration parameter exchangeAuthenticationMethod <br/>15/04/2016 10:57:09 - Trying to set configuration parameter mailboxPause <br/>15/04/2016 10:57:09 - Trying to set configuration parameter domainController <br/>15/04/2016 10:57:09 - Trying to set configuration parameter homeFolderSubDirs <br/>15/04/2016 10:57:09 - Trying to set configuration parameter accountMigratedNovellGroup <br/>15/04/2016 10:57:09 - Trying to set configuration parameter accountMigratedADGroup <br/>15/04/2016 10:57:09 - Trying to set configuration parameter staffSecurityGroup <br/>15/04/2016 10:57:09 - Trying to set configuration parameter studentsSecurityGroup <br/>15/04/2016 10:57:09 - Trying to set configuration parameter liveEduAuthenticationMethod <br/>15/04/2016 10:57:09 - Trying to set configuration parameter liveEduUsername <br/>15/04/2016 10:57:09 - Trying to set configuration parameter liveEduPassword <br/>15/04/2016 10:57:09 - Trying to set configuration parameter liveEduURI <br/>15/04/2016 10:57:09 - Trying to set configuration parameter liveEduSchemaURI <br/>15/04/2016 10:57:09 - Trying to set configuration parameter equitracPause <br/>15/04/2016 10:57:09 - Trying to set configuration parameter passwordSyncGroup <br/>15/04/2016 10:57:09 - Trying to set configuration parameter disableDLUGroup <br/>15/04/2016 10:57:09 - Trying to set configuration parameter adScriptsEnabledGroup <br/>15/04/2016 10:57:09 - Trying to set configuration parameter migratedADGroupsBase <br/>15/04/2016 10:57:09 - Trying to set configuration parameter enableEquitracInitialPrinterCredit <br/>15/04/2016 10:57:09 - Trying to set configuration parameter equitracPause <br/>15/04/2016 10:57:09 - Parameter equitracPause is already configured, it will not be set again. Please check your configuration for duplicate parameters <br/>15/04/2016 10:57:09 - Transaction 12658889 started <br/>15/04/2016 10:57:09 - Processing the ActiveDirectoryNewUser transaction: 12658889 <br/>15/04/2016 10:57:09 - Finding the correct path for user with AccountType: Undergraduate, AccountTypeField: personal <br/>15/04/2016 10:57:09 - Returning 'OU=Students,OU=Users,OU=Non Datacentre' as the user path <br/>15/04/2016 10:57:09 - Setting AD Property: Title = Miss <br/>15/04/2016 10:57:09 - Setting AD Property: userPrincipalName = <a href="mailto:BTD063@salford.ac.uk" class="external-link" rel="nofollow">BTD063@salford.ac.uk</a> <br/>15/04/2016 10:57:09 - Setting AD Property: sAMAccountName = btd063 <br/>15/04/2016 10:57:09 - Setting AD Property: GivenName = G G M Mudiyanselage Gayathri Kalhari <br/>15/04/2016 10:57:09 - Setting AD Property: Initials = G <br/>15/04/2016 10:57:09 - Setting AD Property: Surname = Karunaratne <br/>15/04/2016 10:57:09 - Setting AD Property: Department = Salford Business School <br/>15/04/2016 10:57:09 - Setting AD Property: Password = &lt;***********&gt; <br/>15/04/2016 10:57:09 - Setting AD Property: Description = Student <br/>15/04/2016 10:57:09 - Setting AD Property: Email = <a href="mailto:G.G.M.M.G.Karunaratne@edu.salford.ac.uk" class="external-link" rel="nofollow">G.G.M.M.G.Karunaratne@edu.salford.ac.uk</a> <br/>15/04/2016 10:57:09 - Setting AD Property: Name = Karunaratne G G M Mudiyanselage Gayathri Kalhari G <br/>15/04/2016 10:57:09 - Setting AD Property: CN = Karunaratne G G M Mudiyanselage Gayathri Kalhari G btd063 <br/>15/04/2016 10:57:09 - Setting AD Property: Program = S/BMSR1/F <br/>15/04/2016 10:57:09 - Setting AD Property: Account Status = valid <br/>15/04/2016 10:57:09 - Setting AD Property: DisplayName = Karunaratne G G M <br/>15/04/2016 10:57:09 - Mailstore is empty. Is the mailstore file accessible? <br/>15/04/2016 10:57:09 - Setting the following properties <br/>15/04/2016 10:57:09 - Title=Miss <br/>15/04/2016 10:57:09 - userPrincipalName=BTD063@<a href="http://salford.ac.uk" class="external-link" rel="nofollow">salford.ac.uk</a> <br/>15/04/2016 10:57:09 - sAMAccountName=btd063 <br/>15/04/2016 10:57:09 - GivenName=G G M Mudiyanselage Gayathri Kalhari <br/>15/04/2016 10:57:09 - Initials=G <br/>15/04/2016 10:57:09 - Surname=Karunaratne <br/>15/04/2016 10:57:09 - Department=Salford Business School <br/>15/04/2016 10:57:09 - Description=Student <br/>15/04/2016 10:57:09 - Email=G.G.M.M.G.Karunaratne@<a href="http://edu.salford.ac.uk" class="external-link" rel="nofollow">edu.salford.ac.uk</a> <br/>15/04/2016 10:57:09 - Name=Karunaratne G G M Mudiyanselage Gayathri Kalhari G <br/>15/04/2016 10:57:09 - CN=Karunaratne G G M Mudiyanselage Gayathri Kalhari G btd063 <br/>15/04/2016 10:57:09 - Program=S/BMSR1/F <br/>15/04/2016 10:57:09 - Account Status=valid <br/>15/04/2016 10:57:09 - DisplayName=Karunaratne G G M <br/>15/04/2016 10:57:09 - Finding the correct path for user with AccountType: Undergraduate, AccountTypeField: personal <br/>15/04/2016 10:57:09 - Returning 'OU=Students,OU=Users,OU=Non Datacentre' as the user path <br/>15/04/2016 10:57:10 - Deciding which filestore to use for BTD063 <br/>15/04/2016 10:57:10 - Using \\<a href="http://uos-p-cifs-02.isdads.salford.ac.uk" class="external-link" rel="nofollow">uos-p-cifs-02.isdads.salford.ac.uk</a>\StudentHome_01\BTD063 as the home folder <br/>15/04/2016 10:57:10 - There is no SAP department code for this user. Maybe they are a student or an associate. Using their normal dept name instead. <br/>15/04/2016 10:57:10 - Using this department name from the person record: Salford Business School <br/>15/04/2016 10:57:10 - Saving user in AD... <br/>15/04/2016 10:57:10 - ADUserClassExtensions: SamAccountName = [btd063], Title = [Undergraduate], GivenName = [G G M Mudiyanselage Gayathri Kalhari], Initials = [G], MiddleName = [], Surname = [Karunaratne], Department = [Salford Business School], Description = [Student], Name (CN) = [Karunaratne G G M Mudiyanselage Gayathri Kalhari G btd063], UserPrincipalName = [BTD063@<a href="http://salford.ac.uk" class="external-link" rel="nofollow">salford.ac.uk</a>], PasswordNeverExpires = [True], DisplayName = [Karunaratne G G M], Mail = [G.G.M.M.G.Karunaratne@<a href="http://edu.salford.ac.uk" class="external-link" rel="nofollow">edu.salford.ac.uk</a>], HomeDirectory = [\\<a href="http://uos-p-cifs-02.isdads.salford.ac.uk" class="external-link" rel="nofollow">uos-p-cifs-02.isdads.salford.ac.uk</a>\StudentHome_01\BTD063], PhysicalDeliveryOfficeName = [Salford Business School], uosRfidCsnLong = [], uosRfidCsnShort = [], Enabled = [True], UoSAffiliation = [Undergraduate] <br/>15/04/2016 10:57:10 - Setting AD password to the initial passsword from Accman <br/>15/04/2016 10:57:10 - Secure connection obtained <br/>15/04/2016 10:57:10 - Password has been set to to the value in the account_details table <br/>15/04/2016 10:57:10 - AD Group is S-BMSR1-F <br/>15/04/2016 10:57:10 - Adding user btd063 to group S-BMSR1-F <br/>15/04/2016 10:57:10 - Looking for group... <br/>15/04/2016 10:57:10 - Removing the user from the group in prep for adding them cleanly <br/>15/04/2016 10:57:10 - User removed <br/>15/04/2016 10:57:10 - Adding the user to the group <br/>15/04/2016 10:57:10 - User added to group successfully <br/>15/04/2016 10:57:10 - User btd063 was added to S-BMSR1-F <br/>15/04/2016 10:57:10 - Adding user to StudentsSecurityGroupAll Students Security Group <br/>15/04/2016 10:57:10 - Adding user btd063 to group All Students Security Group <br/>15/04/2016 10:57:10 - Looking for group... <br/>15/04/2016 10:57:10 - Removing the user from the group in prep for adding them cleanly <br/>15/04/2016 10:57:11 - User removed <br/>15/04/2016 10:57:11 - Adding the user to the group <br/>15/04/2016 10:57:12 - User added to group successfully <br/>15/04/2016 10:57:12 - User added to All Students Security Group <br/>15/04/2016 10:57:12 - User is student: True <br/>15/04/2016 10:57:12 - Update: False <br/>15/04/2016 10:57:12 - EnableEquitracInitialPrinterCredit: TRUE <br/>15/04/2016 10:57:12 - Transaction parameter for creating a mailbox exists: False <br/>15/04/2016 10:57:12 - Not staff, not giving them a mailbox in exchange <br/>15/04/2016 10:57:12 - About to add an initial printer credit <br/>15/04/2016 10:57:12 - Creating an initial £2 Equitrac printing credit transaction which will be executed in 240 <br/>15/04/2016 10:57:12 - About to create home folder: \\<a href="http://uos-p-cifs-02.isdads.salford.ac.uk" class="external-link" rel="nofollow">uos-p-cifs-02.isdads.salford.ac.uk</a>\StudentHome_01\BTD063 <br/>15/04/2016 10:57:12 - Home folder did not exist, so creating it <br/>15/04/2016 10:57:12 - Creating sub folder \\<a href="http://uos-p-cifs-02.isdads.salford.ac.uk" class="external-link" rel="nofollow">uos-p-cifs-02.isdads.salford.ac.uk</a>\StudentHome_01\BTD063\Temp <br/>15/04/2016 10:57:12 - Setting ACL rights to folder: \\<a href="http://uos-p-cifs-02.isdads.salford.ac.uk" class="external-link" rel="nofollow">uos-p-cifs-02.isdads.salford.ac.uk</a>\StudentHome_01\BTD063\Temp <br/>15/04/2016 10:57:12 - Creating sub folder \\<a href="http://uos-p-cifs-02.isdads.salford.ac.uk" class="external-link" rel="nofollow">uos-p-cifs-02.isdads.salford.ac.uk</a>\StudentHome_01\BTD063\PMail <br/>15/04/2016 10:57:12 - Setting ACL rights to folder: \\<a href="http://uos-p-cifs-02.isdads.salford.ac.uk" class="external-link" rel="nofollow">uos-p-cifs-02.isdads.salford.ac.uk</a>\StudentHome_01\BTD063\PMail <br/>15/04/2016 10:57:12 - Folder created, setting access rights <br/>15/04/2016 10:57:12 - Setting ACL rights to folder: \\<a href="http://uos-p-cifs-02.isdads.salford.ac.uk" class="external-link" rel="nofollow">uos-p-cifs-02.isdads.salford.ac.uk</a>\StudentHome_01\BTD063 <br/>15/04/2016 10:57:12 - First set of rights granted <br/>15/04/2016 10:57:12 - Second set of rights granted <br/>15/04/2016 10:57:12 - Third set of rights granted <br/>15/04/2016 10:57:12 - Access rights granted to: \\<a href="http://uos-p-cifs-02.isdads.salford.ac.uk" class="external-link" rel="nofollow">uos-p-cifs-02.isdads.salford.ac.uk</a>\StudentHome_01\BTD063 <br/>15/04/2016 10:57:12 - Adding user to NDS group .migrated.systemadministration.groups.salford <br/>15/04/2016 10:57:12 - Adding user: btd063 to Novell group: .migrated.systemadministration.groups.salford <br/>15/04/2016 10:57:12 - User added to .migrated.systemadministration.groups.salford <br/>15/04/2016 10:57:12 - Adding user to AD group G-Staff-FromAccMan <br/>15/04/2016 10:57:12 - Adding user btd063 to group G-Staff-FromAccMan <br/>15/04/2016 10:57:12 - Looking for group... <br/>15/04/2016 10:57:12 - Removing the user from the group in prep for adding them cleanly <br/>15/04/2016 10:57:13 - User removed <br/>15/04/2016 10:57:13 - Adding the user to the group <br/>15/04/2016 10:57:14 - User added to group successfully <br/>15/04/2016 10:57:14 - User added to G-Staff-FromAccMan <br/>15/04/2016 10:57:14 - User BTD063 has been created in Active Directory <br/>15/04/2016 10:57:14 - Adding user to group 'G-PE-bf-bn-$bna' <br/>15/04/2016 10:57:14 - Adding user BTD063 to group G-PE-bf-bn-$bna <br/>15/04/2016 10:57:14 - Looking for group... <br/>15/04/2016 10:57:14 - Removing the user from the group in prep for adding them cleanly <br/>15/04/2016 10:57:14 - User removed <br/>15/04/2016 10:57:14 - Adding the user to the group <br/>15/04/2016 10:57:14 - User added to group successfully <br/>15/04/2016 10:57:14 - AD Details updated: True. User type is: Undergraduate <br/>15/04/2016 10:57:14 - Adding user to group .PasswordSync.Systemadministration.Groups.Salford <br/>15/04/2016 10:57:14 - Adding user: BTD063 to Novell group: .PasswordSync.Systemadministration.Groups.Salford <br/>15/04/2016 10:57:16 - User added to password sync group successfully: True <br/>15/04/2016 10:57:16 - Transaction 12658889 completed </div>
</div></div>
                    </div>

                    
                                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="comments" class="pageSectionTitle">Comments:</h2>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-25628602"></a>
                                    <font class="smallfont"><p>As discussed with <a class="confluence-userlink user-mention" data-username="uis876" href="https://confluence.salford.ac.uk:8444/confluence/display/~uis876" data-linked-resource-id="824264" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://confluence.salford.ac.uk:8444/confluence">Paul Daniels</a>, the initials column on the person table is currently too short for these names too. It's currently set to a max of 5 characters. The case above needed 8. It should be increased, possibly to 10 or 15 otherwise the Banner Import will never be able to put the full set of initials into Accman</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/contenttypes/comment_16.png" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by uis894 at Apr 15, 2016 12:30
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    </div>
                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Mar 29, 2021 10:55</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
