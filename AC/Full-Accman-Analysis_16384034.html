<!DOCTYPE html>
<html>
    <head>
        <title>Accman : Full Accman Analysis</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Accman</a></span>
                            </li>
                                                    <li>
                                <span><a href="Accman-Home_16384043.html">Accman Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Documentation_16384018.html">Documentation</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Accman : Full Accman Analysis
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (uis894)</span>, last modified on Jan 22, 2015
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <div class="confluence-information-macro confluence-information-macro-information"><p class="title">Important Note</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>The following document is a <strong>copy</strong> of the attached word document, added as a web page for ease of reading.</p></div></div><p> </p><p>    
    
<div class="office-container">
    <div data-id="$attachmentObj"></div>
            <div class="container-menu-butttons">
            <div
                class="companion-edit-button-placeholder"
                data-template-name="companionEditButon"
                data-linked-resource-id="16581310"
                data-linked-resource-container-id="16384034" >
            </div>
        </div>
        <div class="office-document">
    <div>
<h1 style="margin-top:24pt; margin-bottom:0pt; text-align:center; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:28pt">
<a name="_Toc318795859">
<span style="font-family:Cambria; color:#365f91">Accman Analysis</span>
</a>
</h1>
<h1 style="margin-top:24pt; margin-bottom:0pt; text-align:center; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:12pt">
<a name="_Toc318795860">
<span style="font-family:Cambria; color:#365f91">Scripts dealing with Department Data</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Richard Gundersen</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Mike Minns</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h3 style="margin-top:10pt; margin-bottom:0pt; text-align:center; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">2nd March 2012</span>
</h3>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795859" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Accman Analysis</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795860" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Scripts dealing with Department Data</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795861" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795862" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Sources of Departmental Data</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795863" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Overview: SAP Import Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795864" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Banner_import.bat</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795865" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Sap_import.bat</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795866" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">sap_import.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795867" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795868" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Transactions Generated</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795869" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795870" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Banner_import.bat</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795871" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795872" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795873" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Staffautostate.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795874" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795875" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795876" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Banner4import.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795877" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795878" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">In Pictures</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795879" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Examples</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795880" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Transactions Generated</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795881" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795882" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Assign.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795883" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795884" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Purpose</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795885" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Transactions Generated</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795886" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795887" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">allocateLib.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795888" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795889" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">In Pictures</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795890" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Examples</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795891" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Depends On</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795892" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Methods</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795893" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Banner4person.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795894" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795895" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">In Pictures</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795896" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Examples</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795897" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Depends On</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795898" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795899" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Banner4Talis.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795900" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795901" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">In Pictures</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795902" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Examples</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795903" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Depends On</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795904" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795905" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">deDuplicateWeekly.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795906" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795907" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">In Pictures</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795908" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Examples</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795909" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Depends On</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795910" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795911" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">DisableAccount.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795912" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795913" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">In Pictures</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795914" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Examples</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795915" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Depends On</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795916" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Methods</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795917" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">EnableAccount.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795918" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795919" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">In Pictures</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795920" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Examples</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795921" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Depends On</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795922" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Methods</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795923" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">EnableDisable.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795924" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795925" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">In Pictures</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795926" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Examples</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795927" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Depends On</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795928" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Methods</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795929" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">restoreUFAA.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795930" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795931" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">In Pictures</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795932" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Examples</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795933" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Depends On</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795934" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795935" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">StudentAutoState.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795936" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795937" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">In Pictures</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795938" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Examples</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795939" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Depends On</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795940" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795941" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">StudentPerson.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795942" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795943" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">In Pictures</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795944" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Examples</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795945" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Depends On</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795946" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795947" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Methods</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795948" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Other Scripts</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795949" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">maillist-staff.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795950" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Transactions generated</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795951" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">maillist-student.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795952" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Transactions generated</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795953" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">mailstaffchanges.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795954" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Transactions generated</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795955" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795956" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">moverename.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795957" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">noshow.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795958" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Transactions generated</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795959" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">pregen_associate.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795960" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Transactions generated</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795961" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">selfReg.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795962" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">staffmultileft.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795963" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Transactions generated</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795964" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795965" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">staffsequential.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795966" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Transactions generated</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795967" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Register.pl</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795968" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Introduction</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795969" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Applies account settings from student account assignment and staff self-registration.</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795970" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Links an account record to its person record &amp; many other things such as setting up email, setting quotas etc</span>
</a>
</p>
<p style="margin-top:0pt; margin-left:11pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795971" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">Process</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795972" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">.NET Processes</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795973" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">TempusCohortCreateUpdateUser</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795974" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">ActivateDirectoryNewUser</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:5pt; line-height:115%; font-size:11pt">
<a href="#_Toc318795975" style="text-decoration:none">
<span style="font-family:Calibri; text-decoration:underline; color:#0000ff">ImportAssociate</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795861">
<span style="font-family:Cambria; color:#365f91">Introduction</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">There is no single, definitive source of departmental information at the university. Different systems have their own list of department names, codes etc. Some even have multiple sources of department information.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Accman imports data from various systems such as Banner and SAP, and pushes data out to many more (AD, Blackboard, Talis). While it is performing many of these tasks, it has to deal with the many formats that the departmental data can be in.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Over the years, Accman has evolved various mechanisms to cope with these different sources of departmental data. It contains a number of tables for storing and mapping e.g. SAP departments to UoS departments. This has led to brittle code that is prone to error and is difficult to maintain. It also makes it very hard to accommodate some types of changes that the business might like to make.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">It also makes it nearly impossible for the business to restructure departments </span>
<span style="font-family:Calibri; font-style:italic">without</span>
<span style="font-family:Calibri"> Accman breaking in some way.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Ideally, there should be one definitive source of departmental data that all systems reference.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This document attempts to show how departmental data is stored and used by Accman.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795862">
<span style="font-family:Cambria; color:#365f91">Sources of Departmental Data</span>
</a>
<a name="_Toc318707474">
<span style="-aw-bookmark-end:_Toc318795862"/>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Below is a list of databases that Accman uses, alongside the tables / columns that contain departmental data.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="height:0pt; display:block; position:absolute; z-index:7">
<img src="plugins/servlet/benryanconversion" width="148" height="173" alt="" style="margin-top:2.8pt; margin-left:10.2pt; -aw-left-pos:11.2pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:3.8pt; -aw-wrap-type:none; position:absolute"/>
</span>
<span style="height:0pt; display:block; position:absolute; z-index:8">
<img src="plugins/servlet/benryanconversion" width="358" height="252" alt="" style="margin-top:2.3pt; margin-left:133.25pt; -aw-left-pos:133.5pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:2.55pt; -aw-wrap-type:none; position:absolute"/>
</span>
<span style="height:0pt; display:block; position:absolute; z-index:11">
<img src="plugins/servlet/benryanconversion" width="22" height="74" alt="" style="margin-top:22.42pt; margin-left:226.88pt; -aw-left-pos:227.25pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:22.8pt; -aw-wrap-type:none; position:absolute"/>
</span>
<span style="font-family:Calibri; font-weight:bold"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="height:0pt; display:block; position:absolute; z-index:9">
<img src="plugins/servlet/benryanconversion" width="148" height="173" alt="" style="margin-top:-1.25pt; margin-left:10.2pt; -aw-left-pos:11.2pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:-0.25pt; -aw-wrap-type:none; position:absolute"/>
</span>
<span style="font-family:Calibri; font-weight:bold"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="height:0pt; display:block; position:absolute; z-index:10">
<img src="plugins/servlet/benryanconversion" width="358" height="67" alt="" style="margin-top:14.8pt; margin-left:133.25pt; -aw-left-pos:133.5pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:15.05pt; -aw-wrap-type:none; position:absolute"/>
</span>
<span style="font-family:Calibri; font-weight:bold"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<div style="width:400pt; height:225pt">
<span style="height:0pt; display:block; position:absolute; z-index:12">
<img src="plugins/servlet/benryanconversion" width="148" height="173" alt="" style="margin-top:94.2pt; margin-left:10.2pt; -aw-left-pos:11.2pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:95.2pt; -aw-wrap-type:none; position:absolute"/>
</span>
<span style="height:0pt; display:block; position:absolute; z-index:13">
<img src="plugins/servlet/benryanconversion" width="358" height="67" alt="" style="margin-top:128.95pt; margin-left:131.75pt; -aw-left-pos:132pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:129.2pt; -aw-wrap-type:none; position:absolute"/>
</span>
</div>
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795863">
<span style="font-family:Cambria; color:#365f91">Overview: SAP Import Process</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:13.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>SAP writes its export data to the ZACCMAN table. Each record represents a member of staff who has arrived / left / changed departments etc and therefore needs updating in Accman.</span>
</li>
<li style="margin-left:13.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>The sap_import.bat file runs on a schedule starts the staff_import.pl script. </span>
</li>
<li style="margin-left:13.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Sap_import.pl sees that the ZACCMAN table contains fresh data, it reads the new records.</span>
</li>
<li style="margin-left:13.35pt; margin-bottom:10pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Sap_import.pl can create or update accounts in Accman depending on certain rules. In both cases, the department code read from the ZACCMAN DEPT table is translated into an Accman-friendly department code, and then written to the person.dept_code column. </span>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold">Go.Bat</span>
</p>
<table cellspacing="0" cellpadding="0" style="border-collapse:collapse">
<tr>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold">Process</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold">Script</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold">Parameters</span>
</p>
</td>
</tr>
<tr>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Pregenerate accounts     </span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> pregen.pl</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 1</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Pregenerate Associates </span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> pregen_associate.pl </span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 88</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Quota</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> quota</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 4</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Password</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> password</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 5</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Enable Disable</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> enableDisable</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 12</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Force</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> forcelogout</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 21</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Move Rename               </span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> moverename.pl</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 28</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Expiry Date</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> expiryDate</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 33</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> New Staff</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> newstaff</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 34</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Gen password.txt</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> password_txt</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 39</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Extend</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> extend</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 40</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Reconcile                 </span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> reconcile</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 41</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Register account</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> register</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 43</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Copy logfile</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> copylog</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 45</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Copy EPP logfile</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> copyEPPlog</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 46</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Assign account to student </span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> assign</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 47</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Live@Edu - CreateUsers        </span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> create_users_processor</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 48</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Live@Edu - ChangePassword     </span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> change_password_processor</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 61</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Live@Edu - DisableUsers      </span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> disable_users_processor</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 62</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> Live@Edu - EnableUsers        </span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> enable_users_processor</span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Transaction ID = 63</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> </span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> </span>
</p>
</td>
<td style="width:148.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:right; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> </span>
</p>
</td>
</tr>
</table>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795864">
<span style="font-family:Cambria; color:#4f81bd">Banner_import.bat</span>
</a>
</h2>
<table cellspacing="0" cellpadding="0" style="width:478.8pt; border-collapse:collapse">
<tr>
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold">Process</span>
</p>
</td>
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold">Script</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Import student data from Banner into AccMan banner_import table</span>
</p>
</td>
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">banner4import.pl</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Import program data from Banner into AccMan prog table</span>
</p>
</td>
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">banner4prog.pl</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Check for no-shows of 'expected' students</span>
</p>
</td>
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">noshow.pl</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Import from banner_import into person table</span>
</p>
</td>
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">banner4person.pl</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Enable accounts that have been disabled previously that are now active studentautostate.pl</span>
</p>
</td>
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> </span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Restore future UFAA status of 'left' students (has to be run after banner4person) It probably doesn't matter if this doesn't get through to Talis (users will be 'expected' rather than 'present')</span>
</p>
</td>
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">restoreUFAA.pl</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Import address data from Banner into AccMan banner_address table</span>
</p>
</td>
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">banner4address.pl</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Export student data and address from AccMan to su_bbreg_fullNNN</span>
</p>
</td>
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">banner4talis.pl</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Export staff reconciliation data from AccMan to su_bbreg_recNN reconcileTalis.pl</span>
</p>
</td>
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial"> </span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">Export staff data from AccMan to su_bbreg_staff</span>
</p>
</td>
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">r#talis_staff.pl</span>
</p>
</td>
</tr>
<tr style="height:12.75pt">
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">FTP su_bbreg to Talis to be processed by borr_import prog run overnight by crontab</span>
</p>
</td>
<td style="width:228.6pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:10pt">
<span style="font-family:Arial">banner4ftp.pl</span>
</p>
</td>
</tr>
</table>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795865">
<span style="font-family:Cambria; color:#365f91">Sap_import.bat</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Runs at 13:10 every day</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Executes the following Perl scripts in order</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">c:\accman\scripts\scheduled\sap_import.pl</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">c:\accman\scripts\scheduled\staffmultipost.pl</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">c:\accman\scripts\scheduled\staffmultileft.pl</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">c:\accman\scripts\scheduled\staffsequential.pl</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">c:\accman\scripts\scheduled\staffautostate.pl</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795866">
<span style="font-family:Cambria; color:#365f91">sap_import.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795867">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This script is executed by sap_import.bat. </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Import users from the SAP database into Accman.</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795868">
<span style="font-family:Cambria; color:#4f81bd">Transactions Generated</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">97 (Update Janus)</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795869">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Keeps looping until it spots that the data in the SAP db is at least 4 minutes old (compares the TIMESTAMP field in ZACCMAN with the timestamp in the sap_import table. This is so we only do anything when there is something worth processing.</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Delete everything from the sap_import table so we have a clean slate.</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Generates a new import ID for this import operation</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Builds a list of reference data used to map SAP values to Accman values for the following items: Title (Reverend </span>
<span style="font-family:Wingdings"></span>
<span>Rev), Department (CAIT </span>
<span style="font-family:Wingdings"></span>
<span>UI) and Grace (last possible date for leavers to have a chance to return)</span>
</li>
<li style="margin-left:31.35pt; margin-bottom:10pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Execute the following SQL to obtain the accounts needing to be processed</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">select </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">PERNR, INITS, SURNAME, FORENAME, TITLE, PREFNAME, MIDNAME, DEPT, SDATE, EDATE, DOB, STATUS, MULTIPOST, TIMESTAMP </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">from </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">ZACCMAN </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">where </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">MANDT = 200 and </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">PERNR != '00000000'</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="6" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; margin-bottom:10pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Inserts the data into the MAIL.SAP_IMPORT table using the following SQL</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">insert into sap_import </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, encrypt(?, ?), ?, ?, ?)</span>
</p>
<ol start="7" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Reads the data back from the MAIL.SAP_IMPORT table and processes each record it finds</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Calls updateStaff()</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Checks that the personnel number is valid (otherwise no further processing is done)</span>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Calculate what the person state should be</span>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Check that the names are correct</span>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Convert the SAP title to an Accman title</span>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Convert the SAP department name to an Accman department name</span>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>We have the personnel number, so look up their person record by looking in the rollmap table (which maps roll/personnel numbers to personIDs</span>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>If no person record is found, create a new one and generate a new rollnumber for them</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Insert the details we have into the person table</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Generate a new rollnumber: this is actually just the personID + 200000000 so if the personID was 1234, their rollnnumber would be 200001234.</span>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt">
<span>Insert the new rollnumber into the rollmap table</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Update the new person record with the generated rollnumber</span>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">insert into person (initials, realname, source_code, person_status_code, dept_code, forenames, person_state, importID, first_importID, title, preferredName, start_date, end_date, secret, multi_post, b_date) values (?, ?, 'P', 'S', ?, ?, ?, $importID, $importID, ?, ?, ?, ?, ?, ?, ?)</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="16" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Otherwise, if a person record is found</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Check that this isn’t a duplicate i.e. there are not two records with the same personnel number in this import</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>If the person has already left and they have not been extended, don’t proceed any further</span>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt">
<span>If an account is due to be extended, set their state to ‘extended’ </span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Update their details in Accman with the following SQL. </span>
<span style="background-color:#ffff00">This updates their department code</span>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">update person </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">set importID = $importID, </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">source_code = 'P', </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">person_status_code = 'S', </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">initials = ?, </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">realname = ?, </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">dept_code = ?, </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">sap_dept_code = ?, </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">forenames = ?, </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">person_state = ?, </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">title = ?, </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">preferredName = ?, </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">start_date = ?, </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">end_date = ?, </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">secret = ?, </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">multi_post = ?, </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">b_date = ? </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:10pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:'Courier New'; font-size:8pt">where personID = ?</span>
<span style="width:21.59pt; text-indent:0pt; display:inline-block"/>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="17" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Creates a Janus (type 97) transaction</span>
</li>
<li style="margin-left:36pt; margin-bottom:10pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Mark the import as complete</span>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795870">
<span style="font-family:Cambria; color:#365f91">Banner_import.bat</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:14pt">
<span style="font-family:Calibri"> </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795871">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This script is run as a windows scheduled task. There are two run modes (both are scheduled to run)</span>
</p>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Incremental: every weekday, at 11:30am. </span>
</li>
<li style="margin-left:31.35pt; margin-bottom:10pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Full: every weekday, at 7:30pm</span>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">A command line parameter called “-inc” is passed in to specify whether the script should run in full or incremental mode. If “-inc” is present as the first command line parameter, the script will run in </span>
<span style="font-family:Calibri; font-style:italic">incremental</span>
<span style="font-family:Calibri"> mode, otherwise it will run in </span>
<span style="font-family:Calibri; font-style:italic">full</span>
<span style="font-family:Calibri"> mode. </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Looking at the configuration for the scheduled task, it looks something like this (note the “-inc” parameter is passed in this example, signifying that this task runs the script in incremental mode:</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-style:italic">cmd /c start "Banner import" /DC:\accman\logs C:\accman\batch\banner_import.bat -inc</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795872">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This batch script is a lightweight wrapper around many other Perl scripts. It calls the various scripts in the following order</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<table cellspacing="0" cellpadding="0" style="border-collapse:collapse">
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top; background-color:#fdeada">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Script Name</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top; background-color:#fdeada">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Incremental</span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top; background-color:#fdeada">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Purpose</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">banner4imort.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">X</span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Copies data from Banner to Accman</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">banner4prog.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Import program data from Banner into AccMan prog table</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">noshow.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Check for no-shows of 'expected' students</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">banner4person.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Import from banner_import into person table</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">assign.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Import from banner into banner_syraccs table and assign any allocated accounts to the correct student</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">studentautostate.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">X</span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Enable accounts that have been disabled previously that are now active and disable ones where student has now left or is absent</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">restoreUFAA.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Restore future UFAA status of 'left' students (has to be run after banner4person) It probably doesn't matter if this doesn't get through to Talis (users will be 'expected' rather than 'present')</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">banner4address.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Import address data from Banner into AccMan banner_address table</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">banner4talis.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Export student data and address from AccMan to su_bbreg_fullNNN</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">reconcileTalis.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Export staff reconciliation data from AccMan to su_bbreg_recNN</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">talis_staff.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Export staff data from AccMan to su_bbreg_staff</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">banner4ftp.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">FTP su_bbreg to Talis to be processed by borr_import prog run overnight by crontab</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">banner4talis.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">X</span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Export incremental student data from AccMan to su_bbreg_incNNN</span>
</p>
</td>
</tr>
<tr>
<td style="width:93.85pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">banner4ftp.pl</span>
</p>
</td>
<td style="width:54.05pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; text-align:center; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">X</span>
</p>
</td>
<td style="width:281.8pt; padding-right:5.4pt; padding-left:5.4pt; vertical-align:top">
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">FTP su_bbreg_incNNN to Talis to be processed by borr_import prog run by crontab</span>
</p>
</td>
</tr>
</table>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<br style="page-break-before:always; clear:both"/>
<a name="_Toc318795873">
<span style="font-family:Cambria; color:#365f91">Staffautostate.pl</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:14pt">
<span style="font-family:Calibri"> </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795874">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Executed as part of the SAP import process. Enable or disable accounts affected by the most recent SAP import depending on their status. </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795875">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Get the latest import information from the person_import table</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Get a list of staff accounts which are candidates for being re-enabled i.e. their account records are disabled</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">select </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">a.accID, a.username, p.personID </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">from </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">account a, person p, department_status ds, dept_person_account d </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">where p.personID = a.personID </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and p.person_state = 'present' </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and p.source_code = 'P' </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and p.person_status_code = 'S' </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and a.status_code = 'S' </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and a.state in ('disabled', 'deletable') </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and a.accountType = 'personal' </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and a.department_status_code = ds.department_status_code </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and p.dept_code = d.person_dept_code </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and ds.dept_code = d.account_dept_code </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and (a.DisabledReason in ('Person has left', 'User has left - extension expired') </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    or a.DisabledReason like 'User has left%');</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="3" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>See if there are any other valid account records with the same personID but are different to the account already retrieved in step 2. I.e. Bob has two accounts, one that’s disabled (step 2), and one that’s valid (step 3)</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">select </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">a.username </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">from </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">account a, person p, department_status ds, dept_person_account d </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">where p.personID = ? </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">and p.personID = a.personID </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">and p.person_status_code = 'S' </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">and a.status_code = 'S' </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">and a.state = 'valid' </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">and a.accountType = 'personal' </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">and a.department_status_code = ds.department_status_code </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">and p.dept_code = d.person_dept_code </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">and ds.dept_code = d.account_dept_code </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">and a.accID != ?</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'"> </span>
</p>
<ol start="4" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>If Bob does have a valid account (retrieved in step 3) then disable the first one (but it’s already disabled isn’t it?) because they are now using the one from step 3. Calls disableAccount() on the account from step 2.</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>If Bob does </span>
<span style="font-style:italic">not</span>
<span> have another valid account, the one from step 2 can be re-enabled because they must have returned. Calls enableAccount() on the account from step 2</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Finally, find any accounts that definitely need to be disabled by running the following query. Call disableAccount() on each account that is retrieved.</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">select a.accID, a.username </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    from account a, person p </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">where p.personID = a.personID </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and p.person_state = 'left' </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and p.source_code = 'P' </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and a.state = 'valid' </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:10pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    and a.accountType = 'personal'</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795876">
<span style="font-family:Cambria; color:#365f91">Banner4import.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<span style="font-family:Cambria; color:#4f81bd"> </span>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795877">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This script is executed by banner_import.bat, which runs as a windows scheduled task. There are two run modes, and both are </span>
</p>
<ol start="3" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Incremental: every weekday, at 11:30am. </span>
</li>
<li style="margin-left:31.35pt; margin-bottom:10pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Full: every weekday, at 7:30pm</span>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">The purpose of Banner4import.pl is to copy information out of the Banner database, and into the Accman (Mail) database. Once this is done, other scripts carry out further processing.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795878">
<span style="font-family:Cambria; color:#4f81bd">In Pictures</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="height:0pt; display:block; position:absolute; z-index:2">
<img src="plugins/servlet/benryanconversion" width="135" height="75" alt="" style="margin-top:10.85pt; margin-left:155.45pt; -aw-left-pos:155.95pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:11.35pt; -aw-wrap-type:none; position:absolute"/>
</span>
<span style="height:0pt; display:block; position:absolute; z-index:0">
<img src="plugins/servlet/benryanconversion" width="105" height="132" alt="" style="margin-top:14.1pt; margin-left:6.5pt; -aw-left-pos:7.5pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:15.1pt; -aw-wrap-type:none; position:absolute"/>
</span>
<span style="height:0pt; display:block; position:absolute; z-index:1">
<img src="plugins/servlet/benryanconversion" width="128" height="132" alt="" style="margin-top:19.35pt; margin-left:353.75pt; -aw-left-pos:354.75pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:20.35pt; -aw-wrap-type:none; position:absolute"/>
</span>
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="height:0pt; display:block; position:absolute; z-index:4">
<img src="plugins/servlet/benryanconversion" width="133" height="42" alt="" style="margin-top:4.28pt; margin-left:255.38pt; -aw-left-pos:255.75pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:4.65pt; -aw-wrap-type:none; position:absolute"/>
</span>
<span style="height:0pt; display:block; position:absolute; z-index:3">
<img src="plugins/servlet/benryanconversion" width="97" height="28" alt="" style="margin-top:6.93pt; margin-left:83.62pt; -aw-left-pos:84pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:9.15pt; -aw-wrap-type:none; position:absolute"/>
</span>
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="height:0pt; display:block; position:absolute; z-index:5">
<img src="plugins/servlet/benryanconversion" width="65" height="50" alt="" style="margin-top:1.45pt; margin-left:96.5pt; -aw-left-pos:96.75pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:1.7pt; -aw-wrap-type:none; position:absolute"/>
</span>
<span style="height:0pt; display:block; position:absolute; z-index:6">
<img src="plugins/servlet/benryanconversion" width="65" height="50" alt="" style="margin-top:1.45pt; margin-left:278.75pt; -aw-left-pos:279pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:1.7pt; -aw-wrap-type:none; position:absolute"/>
</span>
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795879">
<span style="font-family:Cambria; color:#4f81bd">Examples</span>
</a>
</h2>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>When run in </span>
<span style="font-weight:bold">incremental</span>
<span> mode, assuming today’s date is 28</span>
<span style="font-size:7.33pt; vertical-align:super">th</span>
<span> Feb 2012</span>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri">current_sess = 2012</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri">first_sess = 2012</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri">term = 201200</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">maxterm = 201299</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">So, students will only be retrieved if (among other things) their term code is between 201200 and 201299</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="2" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>When run in </span>
<span style="font-weight:bold">full</span>
<span> mode on 28</span>
<span style="font-size:7.33pt; vertical-align:super">th</span>
<span> Feb 2012</span>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">current_sess = 2012</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">first_sess = 2011</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">term = 201100</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">maxterm = 201299</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">So, students will only be retrieved if (among other things) their term code is between 201100 and 201299</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="3" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>When run in </span>
<span style="font-weight:bold">incremental</span>
<span> mode, assuming today’s date is 10</span>
<span style="font-size:7.33pt; vertical-align:super">th</span>
<span> Nov 2012</span>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri">current_sess = 2013</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri">first_sess = 2013</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri">term = 201300</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">maxterm = 201399</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">So, students will only be retrieved if (among other things) their term code is between 201300 and 201399</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="4" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>When run in </span>
<span style="font-weight:bold">full</span>
<span> mode on 10</span>
<span style="font-size:7.33pt; vertical-align:super">th</span>
<span> Nov 2012</span>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">current_sess = 2013</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">first_sess = 2012</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">term = 201200</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">maxterm = 201399</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">So, students will only be retrieved if (among other things) their term code is between 201200 and 201399</span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<span style="font-family:Cambria; color:#4f81bd"> </span>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795880">
<span style="font-family:Cambria; color:#4f81bd">Transactions Generated</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">None</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795881">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Connect to the Mail database</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Connect to the Banner database</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Define </span>
<span style="font-style:italic">current_sess(ion)</span>
<span> as e.g. </span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>2012 (if today &lt; 01 July 2012)</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>2013 (today &gt; after 30 June 2012).</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Define </span>
<span style="font-style:italic">first_sess(ion)</span>
<span> as </span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span style="font-style:italic">current_sess</span>
<span> (if incremental) e.g. 2012</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span style="font-style:italic">current_sess – 1</span>
<span> (otherwise) e.g. 2011</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Define term as ‘&lt;first_sess&gt;00’ </span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>e.g. 201200</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Define maxterm as ‘&lt;current_sess&gt;99’ </span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>e.g. 201299</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Delete all records from the banner import table in the Mail database</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Delete from mail.banner_import</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; margin-bottom:10pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Prepare the select script. Reads student data from the BANNER database, ready to be inserted into the MAIL.BANNER_IMPORT table</span>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:0pt; text-indent:18pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SELECT DISTINCT</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPRIDEN_PIDM,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPRIDEN_ID,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPRIDEN_LAST_NAME,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPRIDEN_FIRST_NAME,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPRIDEN_MI,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPBPERS_BIRTH_DATE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPBPERS_SEX,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPBPERS_NAME_PREFIX,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_TERM_CODE_EFF,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_STST_CODE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_LEVL_CODE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_STYP_CODE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_DEGC_CODE_1,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_MAJR_CODE_1,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_BLCK_CODE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'; background-color:#ffff00">SGBSTDN_DEPT_CODE</span>
<span style="font-family:'Courier New'">,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_PROGRAM_1,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SFBETRM_AR_IND,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SFBETRM_ADD_DATE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SFBETRM_ESTS_CODE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SKBHINS_ENDDATE</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">FROM</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">spriden JOIN spbpers</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">ON spriden_pidm = spbpers_pidm</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">JOIN sgbstdn</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">ON spriden_pidm = sgbstdn_pidm</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">JOIN sfbetrm</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">ON spriden_pidm = sfbetrm_pidm</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">LEFT JOIN</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">(SELECT ins1.skbhins_pidm, stdn1.sgbstdn_term_code_admit,</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  MAX(ins1.skbhins_enddate) AS skbhins_enddate</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  FROM skbhins ins1, sgbstdn stdn1</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  WHERE NOT EXISTS (SELECT 1</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    FROM skbhins ins2</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    WHERE ins2.skbhins_pidm = ins1.skbhins_pidm</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    AND ins2.skbhins_enddate IS NULL</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    AND ins2.skbhins_term_code = ins1.skbhins_term_code</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    AND ins1.skbhins_active_ind = 'Y'</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    AND ins2.skbhins_active_ind = 'Y')</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  AND ins1.skbhins_term_code = stdn1.sgbstdn_term_code_admit</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  AND ins1.SKBHINS_PIDM = stdn1.sgbstdn_pidm</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  GROUP BY ins1.skbhins_pidm, sgbstdn_term_code_admit</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">UNION</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SELECT ins1.skbhins_pidm, stdn1.sgbstdn_term_code_admit,</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  NULL AS skbhins_enddate</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  FROM skbhins ins1, sgbstdn stdn1</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  WHERE EXISTS (SELECT 1</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    FROM skbhins ins2</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    WHERE ins2.skbhins_pidm = ins1.skbhins_pidm</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    AND ins2.skbhins_enddate IS NULL</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    AND ins2.SKBHINS_TERM_CODE = ins1.SKBHINS_TERM_CODE</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    AND ins1.skbhins_active_ind = 'Y'</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    AND ins2.skbhins_active_ind = 'Y')</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    AND ins1.skbhins_term_code = stdn1.sgbstdn_term_code_admit</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">    AND ins1.skbhins_pidm = stdn1.sgbstdn_pidm) ains</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">ON spriden_pidm = skbhins_pidm AND ains.sgbstdn_term_code_admit = sgbstdn.sgbstdn_term_code_admit</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">WHERE</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">sgbstdn_term_code_eff = sfbetrm_term_code</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">AND spriden_change_ind IS NULL</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">AND SUBSTR(sfbetrm_term_code,1,4) =</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'"> (SELECT</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  MAX(SUBSTR(sfbetrm_term_code,1,4))</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  FROM</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  spriden spri2, sfbetrm</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  WHERE</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  spri2.spriden_pidm = spriden.spriden_pidm</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  AND sfbetrm_ests_code != 'EL'</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  AND sfbetrm_term_code BETWEEN &lt;term&gt; AND &lt;maxterm&gt;</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">  AND spri2.spriden_pidm = sfbetrm_pidm)</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">ORDER BY spriden_id</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="9" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; margin-bottom:10pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>For each record retrieved in the previous step, insert them into the MAIL.BANNER_IMPORT table </span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">INSERT INTO BANNER_IMPORT </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">(</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPRIDEN_PIDM,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPRIDEN_ID,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPRIDEN_LAST_NAME,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPRIDEN_FIRST_NAME,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPRIDEN_MI,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPBPERS_BIRTH_DATE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPBPERS_SEX,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SPBPERS_NAME_PREFIX,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_TERM_CODE_EFF,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_STST_CODE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_LEVL_CODE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_STYP_CODE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_DEGC_CODE_1,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_MAJR_CODE_1,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_BLCK_CODE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_DEPT_CODE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SGBSTDN_PROGRAM_1,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SFBETRM_AR_IND,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SFBETRM_ADD_DATE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SFBETRM_ESTS_CODE,</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">SKBHINS_ENDDATE</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">)</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:'Courier New'">VALUES (&lt;values retrieved from the select statement&gt;)</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795882">
<span style="font-family:Cambria; color:#365f91">Assign.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<span style="font-family:Cambria; color:#4f81bd"> </span>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795883">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Assign is a Perl script that is executed as a standard transaction processor. It is started via go.bat and once running, periodically checks for any type 47 transactions in the Mail database. </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795884">
<span style="font-family:Cambria; color:#4f81bd">Purpose</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">The purpose of this script is to read account information that has recently come into Accman via the </span>
<span style="font-family:Calibri; font-style:italic">banner4import</span>
<span style="font-family:Calibri"> process (described in another section in this document), and converts that loosely-structured information into proper account/person records.</span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795885">
<span style="font-family:Cambria; color:#4f81bd">Transactions Generated</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">None</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:14pt">
<span style="font-family:Calibri"> </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795886">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; margin-bottom:10pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Executes the following SQL query</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:54pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SELECT</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SYRACCS_ROWNUM, SYRACCS_ACCMAN_STATUS, SYRACCS_USERNAME, SYRACCS_PIDM, </span>
<span style="font-family:Calibri; background-color:#ffff00">SYRACCS_DEPT_CODE</span>
<span style="font-family:Calibri">, SYRACCS_LEVL_CODE </span>
</p>
<p style="margin-top:0pt; margin-left:54pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">FROM</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SYRACCS</span>
</p>
<p style="margin-top:0pt; margin-left:54pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">WHERE </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SYRACCS_SIS_STATUS = 'A' and SYRACCS_ACCMAN_STATUS in ('N', 'R') and ROWNUM = 1</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="2" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; margin-bottom:10pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Get the number of records affected by running a similar SQL query (with a count this time). Stored in </span>
<span style="font-style:italic">count_matching_records</span>
<span>.</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:54pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SELECT </span>
</p>
<p style="margin-top:0pt; margin-left:54pt; margin-bottom:0pt; text-indent:18pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">COUNT(*) </span>
</p>
<p style="margin-top:0pt; margin-left:54pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">FROM </span>
</p>
<p style="margin-top:0pt; margin-left:54pt; margin-bottom:0pt; text-indent:18pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SYRACCS </span>
</p>
<p style="margin-top:0pt; margin-left:18pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">WHERE </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SYRACCS_SIS_STATUS = 'A' and SYRACCS_ACCMAN_STATUS IN ('N', 'R')</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="3" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>For each account retrieved in step 1, do the following</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; margin-bottom:10pt; padding-left:4.95pt">
<span>Get the student details based on the PIDM </span>
<span style="color:#548dd4">[processAccount, getStudentDetails]</span>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">select distinct</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SPRIDEN_ID, SPRIDEN_LAST_NAME, SPRIDEN_FIRST_NAME, SPRIDEN_MI,</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SPBPERS_BIRTH_DATE, SPBPERS_SEX, SPBPERS_NAME_PREFIX</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">from</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SPRIDEN join SPBPERS on SPRIDEN_PIDM = SPBPERS_PIDM(+)</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">where</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SPRIDEN_CHANGE_IND is NULL</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">and SPRIDEN_PIDM = ?</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="2" type="a" style="margin:0pt; padding-left:0pt">
<li style="margin-left:67.56pt; line-height:115%; padding-left:4.44pt; font-family:Calibri; font-size:11pt">
<span>Get the course details for the student</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">select distinct</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SGBSTDN_TERM_CODE_EFF, SGBSTDN_STST_CODE, SGBSTDN_LEVL_CODE, SGBSTDN_STYP_CODE,</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SGBSTDN_DEGC_CODE_1, SGBSTDN_MAJR_CODE_1, SGBSTDN_BLCK_CODE, SGBSTDN_DEPT_CODE, SGBSTDN_PROGRAM_1</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">from SGBSTDN S1</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">where SGBSTDN_TERM_CODE_EFF =</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">  (select max(SGBSTDN_TERM_CODE_EFF) from SGBSTDN S2 where S1.SGBSTDN_PIDM = S2.SGBSTDN_PIDM and S2.SGBSTDN_DEPT_CODE = ? and S2.SGBSTDN_LEVL_CODE = ?)</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">and SGBSTDN_PIDM = ?</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="3" type="a" style="margin:0pt; padding-left:0pt">
<li style="margin-left:66.43pt; line-height:115%; padding-left:5.57pt; font-family:Calibri; font-size:11pt">
<span>If we have a value for SGBSTDN_TERM_CODE_EFF,  retrieve the student’s registration details for this term if they exist and they are not ‘EL’ (eligible to register).</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">select distinct SFBETRM_AR_IND, SFBETRM_ADD_DATE, SFBETRM_ESTS_CODE</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">from SFBETRM</span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">where SFBETRM_TERM_CODE = ? and SFBETRM_ESTS_CODE != 'EL' and SFBETRM_PIDM = ?</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="4" type="a" style="margin:0pt; padding-left:0pt">
<li style="margin-left:67.56pt; line-height:115%; padding-left:4.44pt; font-family:Calibri; font-size:11pt">
<span>If the course details exist i.e. we have a value for SGBSTDN_TERM_CODE_EFF, get the student’s end date</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">select COUNT(*) from SKBHINS where SKBHINS_ENDDATE is NULL and SKBHINS_ACTIVE_IND = 'Y' and SKBHINS_PIDM = ?</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">If the query above returns 0 (because there is not SKBHINS record) or there is an end date, try to get the end date using this query</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; text-indent:9pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">select MAX(SKBHINS_ENDDATE) </span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; text-indent:9pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">from SKBHINS </span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; text-indent:9pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">where SKBHINS_ACTIVE_IND = 'Y' and SKBHINS_PIDM = ?</span>
</p>
<p style="margin-top:0pt; margin-left:135pt; margin-bottom:0pt; text-indent:9pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="5" type="a" style="margin:0pt; padding-left:0pt">
<li style="margin-left:67.25pt; line-height:115%; padding-left:4.75pt; font-family:Calibri; font-size:11pt">
<span>If we don’t have a value for SGBSTDN_TERM_CODE_EFF, we need to set certain values ourselves (some of which are hardcoded, and some of which come from the SYRACCS table (see earlier queries)</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    $SGBSTDN_TERM_CODE_EFF = '000000';</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    $SGBSTDN_STST_CODE = 'AS';</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    $SGBSTDN_LEVL_CODE = $SYRACCS_LEVL_CODE;</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    $SGBSTDN_STYP_CODE = '';</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    $SGBSTDN_DEGC_CODE_1 = '';</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    $SGBSTDN_MAJR_CODE_1 = '';</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    $SGBSTDN_BLCK_CODE = '';</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    </span>
<span style="font-family:Calibri; background-color:#ffff00">$SGBSTDN_DEPT_CODE = $SYRACCS_DEPT_CODE</span>
<span style="font-family:Calibri">;</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    $SGBSTDN_PROGRAM_1 = '';</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="6" type="a" style="margin:0pt; padding-left:0pt">
<li style="margin-left:65.13pt; line-height:115%; padding-left:6.87pt; font-family:Calibri; font-size:11pt">
<span style="font-weight:bold; color:#ff0000">Note</span>
<span>: at this point, we can say that the department code has come either from the </span>
<span>SGBSTDN table</span>
<span> (see the banner4import.pl script) or if it wasn’t available from there, from the SYRACCS table.</span>
</li>
<li style="margin-left:66.95pt; line-height:115%; padding-left:5.05pt; font-family:Calibri; font-size:11pt">
<span>If we don’t have a value for SFBETRM_ESTS_CODE at this point, set a few default values</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    $SFBETRM_AR_IND = 'N';</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    $SFBETRM_ADD_DATE = datenow ();</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    $SFBETRM_ESTS_CODE = 'EL';</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="8" type="a" style="margin:0pt; padding-left:0pt">
<li style="margin-left:67.56pt; line-height:115%; padding-left:4.44pt; font-family:Calibri; font-size:11pt">
<span>We can now start constructing Accman data based on what we retrieved from Banner. This is done using methods in the </span>
<span style="font-weight:bold; color:#548dd4">studentPerson.pl </span>
<span>script</span>
<span>. There is a separate section in the document that explains this script in detail. </span>
</li>
<li style="margin-left:64.3pt; line-height:115%; padding-left:7.7pt; font-family:Calibri; font-size:11pt">
<span>First, create the person record by executing:</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold; color:#548dd4">studentPerson.parsePerson</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="10" type="a" style="margin:0pt; padding-left:0pt">
<li style="margin-left:64.41pt; line-height:115%; padding-left:7.59pt; font-family:Calibri; font-size:11pt">
<span>Check that the rollnumber has a value. If not, this record is invalid and we should not proceed any further with this student.</span>
</li>
<li style="margin-left:66.78pt; line-height:115%; padding-left:5.22pt; font-family:Calibri; font-size:11pt">
<span>Next, work out what the Accman values for their course should be by executing</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold; color:#548dd4">studentPerson.parseCourse</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="12" type="a" style="margin:0pt; padding-left:0pt">
<li style="margin-left:64.3pt; line-height:115%; padding-left:7.7pt; font-family:Calibri; font-size:11pt">
<span>Get the Accman values for their registration details by executing </span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold; color:#548dd4">studentPerson.parseRegistration</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="13" type="a" style="margin:0pt; padding-left:0pt">
<li style="margin-left:70.56pt; line-height:115%; padding-left:1.44pt; font-family:Calibri; font-size:11pt">
<span>Now retrieve the ID of the last successful import </span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">select max(importID) from person_import where source_code = 'S' and completed = 'Y'</span>
</p>
<p style="margin-top:0pt; margin-left:99pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="14" type="a" style="margin:0pt; padding-left:0pt">
<li style="margin-left:67.56pt; line-height:115%; padding-left:4.44pt; font-family:Calibri; font-size:11pt">
<span style="font-style:italic">Reject</span>
<span>: the three methods above (parsePerson, parseCourse, parseRegistration) make a note of any student data that for some reason is deemed invalid. Any invalid fields are written to a log file for checking (presumably)</span>
</li>
<li style="margin-left:67.58pt; line-height:115%; padding-left:4.42pt; font-family:Calibri; font-size:11pt">
<span>Call </span>
<span style="font-weight:bold; color:#548dd4">studentPerson.updateStudentPerson</span>
<span>, which takes all the values we have derived from the Banner database, and writes them to the Accman table</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="4" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Get the acID, personID &amp; state fields from the account table where the username matches the username stored in the SYRACCS table. Note: this will only continue if an account is found. The account must exist, however the person record attached to the account does not necessarily need to exist. Calls the method </span>
<span style="font-weight:bold; color:#548dd4">current()</span>
<span> to work this out</span>
<span style="font-weight:bold">.</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="5" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>If the account ID exists…</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:54pt; margin-bottom:0pt; text-indent:18pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">If PersonID = -1 </span>
</p>
<p style="margin-top:0pt; margin-left:54pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:18pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri; color:#00b050">SUCCESS</span>
<span style="font-family:Calibri">: Call </span>
<span style="font-family:Calibri; font-weight:bold; color:#548dd4">assignAccount()</span>
<span style="font-family:Calibri"> to assign a new account, this is a new person</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri">If account.PersonID != personID</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri; color:#ff0000">FAIL</span>
<span style="font-family:Calibri">: log warning, the account is assigned to someone else</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri">If </span>
<span style="font-family:Calibri; font-style:italic">state</span>
<span style="font-family:Calibri"> matches </span>
<span style="font-family:Calibri; color:#4f6228">'new'</span>
<span style="font-family:Calibri">, </span>
<span style="font-family:Calibri; color:#4f6228">'printed'</span>
<span style="font-family:Calibri">, or</span>
<span style="font-family:Calibri; color:#4f6228"> 'used' </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri; color:#00b050">SUCCESS</span>
<span style="font-family:Calibri">: Call </span>
<span style="font-family:Calibri; font-weight:bold; color:#548dd4">assignAccount()</span>
<span style="font-family:Calibri"> to assign a new account</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri">If </span>
<span style="font-family:Calibri; font-style:italic">state</span>
<span style="font-family:Calibri"> matches </span>
<span style="font-family:Calibri; color:#4f6228">'valid'</span>
<span style="font-family:Calibri">, </span>
<span style="font-family:Calibri; color:#4f6228">'assigned'</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri; color:#00b050">SUCCESS</span>
<span style="font-family:Calibri">: no need to assign the account, its already done</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri">If </span>
<span style="font-family:Calibri; font-style:italic">state</span>
<span style="font-family:Calibri"> matches: </span>
<span style="font-family:Calibri; color:#4f6228">'disabled'</span>
<span style="font-family:Calibri">, </span>
<span style="font-family:Calibri; color:#4f6228">'deletable'</span>
<span style="font-family:Calibri">, </span>
<span style="font-family:Calibri; color:#4f6228">'expired'</span>
<span style="font-family:Calibri">, </span>
<span style="font-family:Calibri; color:#4f6228">'failed'</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri; color:#00b050">SUCCESS</span>
<span style="font-family:Calibri">: account needs to be reactivated</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri">Calls </span>
<span style="font-family:Calibri; font-weight:bold; color:#548dd4">enableAccount()</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri">If </span>
<span style="font-family:Calibri; font-style:italic">state</span>
<span style="font-family:Calibri"> matches </span>
<span style="font-family:Calibri; color:#4f6228">'deleting'</span>
<span style="font-family:Calibri">, </span>
<span style="font-family:Calibri; color:#4f6228">'deleted'</span>
<span style="font-family:Calibri">, </span>
<span style="font-family:Calibri; color:#4f6228">'invalid'</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri; color:#ff0000">FAIL</span>
<span style="font-family:Calibri">: account cannot be enabled</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri">else </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
<span style="font-family:Calibri; color:#ff0000">FAIL</span>
<span style="font-family:Calibri">: generic error message</span>
</p>
<ol start="6" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Disable any other person records that this account might have been linked to</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Execute the following SQL query</span>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">select </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">accID, username </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">from </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">account a </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">where </span>
</p>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">(state = 'valid' or (state = 'disabled' and (disabledReason in ('Student has left', 'Student is absent', 'User has left - extension expired', 'Student has probably left') or (disabledReason like 'Now using%' and disabledReason != concat('Now using ', ?)) or disabledReason like 'Already using%'))) and accountType = 'personal' and personID = ? and accID != ?</span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="2" type="a" style="margin:0pt; padding-left:0pt">
<li style="margin-left:67.56pt; line-height:115%; padding-left:4.44pt; font-family:Calibri; font-size:11pt">
<span>Call the standard </span>
<span style="font-weight:bold; color:#548dd4">disable()</span>
<span> method to disable each returned record</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="7" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Update the SISassign table to log the outcome of this assign record (for auditing). </span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Finally, update the banner SYRACCS table</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">update </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SYRACCS </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">set </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SYRACCS_ACCMAN_STATUS = 'A', </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SYRACCS_ACTIVITY_DATE = SYSDATE </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">where </span>
</p>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:0pt; text-indent:36pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SYRACCS_ROWNUM = ?</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="width:36pt; display:inline-block"/>
<span style="width:36pt; display:inline-block"/>
</p>
<p style="margin-top:0pt; margin-left:90pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795887">
<span style="font-family:Cambria; color:#365f91">allocateLib.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795888">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri">Routines to allocate and optionally update accounts in SYRACCS</span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795889">
<span style="font-family:Cambria; color:#4f81bd">In Pictures</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795890">
<span style="font-family:Cambria; color:#4f81bd">Examples</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795891">
<span style="font-family:Cambria; color:#4f81bd">Depends On</span>
</a>
</h2>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Perl Packages</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Warnings</span>
</li>
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Strict</span>
</li>
<li style="margin-left:28.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">DBI</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Modules</span>
</h3>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Tables</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">MAIL</span>
<span style="font-family:Calibri"> </span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">ACCOUNT</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">ACCOUNT_DETAILS</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">DEPARTMENT_STATUS</span>
</li>
<li style="margin-left:29.6pt; margin-bottom:10pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PERSON</span>
</li>
</ul>
</li>
</ul>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795892">
<span style="font-family:Cambria; color:#4f81bd">Methods</span>
</a>
</h2>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt; font-style:italic">
<span>newAccountToSYRACCS</span>
<span> ()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; padding-left:4.57pt">
<span style="font-style:normal">Get account information where account type is NDS for a specified student</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:normal">select plain_text_password, d.dept_code, a.status_code, state, PIDM from account a join account_details ad on (a.accID = ad.accID) join </span>
<span style="font-style:normal; background-color:#ffff00">department_status</span>
<span style="font-style:normal"> d on (d.department_status_code = a.department_status_code) left join person p on (a.personID = p.personID) where ad.type = 'NDS' and username = ?</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt; font-style:normal">
<span>Filter out any accounts which aren’t ‘new’ or aren’t Student accounts</span>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt; font-style:normal">
<span>Determine the Banner Dept Code and Level</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">deptAndLevel()</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt; font-style:normal">
<span>Read the current Banner account information for the student</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select SYRACCS_ROWNUM, SYRACCS_ACCMAN_STATUS, SYRACCS_PIDM, SYRACCS_SIS_STATUS, SYRACCS_INIT_PASSWORD, </span>
<span style="background-color:#ffff00">SYRACCS_DEPT_CODE, SYRACCS_LEVL_CODE</span>
<span> from SYRACCS where SYRACCS_USERNAME = ?</span>
</li>
</ol>
</li>
<li style="margin-left:31.25pt; padding-left:4.75pt; font-style:normal">
<span>If the account does not exist in Banner create it</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>insert into SYRACCS (SYRACCS_USERNAME, SYRACCS_ACCMAN_STATUS, SYRACCS_PIDM, SYRACCS_SIS_STATUS, SYRACCS_INIT_PASSWORD, </span>
<span style="background-color:#ffff00">SYRACCS_DEPT_CODE, SYRACCS_LEVL_CODE</span>
<span>, SYRACCS_ACTIVITY_DATE) values (?, ?, ?, ?, ?, ?, ?, SYSDATE)</span>
</li>
</ol>
</li>
<li style="margin-left:29.13pt; padding-left:6.87pt; font-style:normal">
<span>If the account does exist in Banner and ????? no PIDM and $SYRACCS_ACCMAN_STATUS ne 'N' or $SYRACCS_SIS_STATUS ne 'N' or $SYRACCS_DEPT_CODE ne $dept_code or $SYRACCS_LEVL_CODE ne $level_code</span>
<span>              </span>
<span>the Update the Banner account</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>update SYRACCS set SYRACCS_USERNAME = ?, SYRACCS_ACCMAN_STATUS = ?, SYRACCS_PIDM = ?, SYRACCS_SIS_STATUS = ?, SYRACCS_INIT_PASSWORD = ?, </span>
<span style="background-color:#ffff00">SYRACCS_DEPT_CODE = ?, SYRACCS_LEVL_CODE = ?,</span>
<span> SYRACCS_ACTIVITY_DATE = SYSDATE where SYRACCS_ROWNUM = ?</span>
<span>              </span>
<span>              </span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt; font-style:italic">
<span>studentAccountToSYRACCS</span>
<span> ()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; padding-left:4.57pt">
<span style="font-style:normal">Get the Student account information</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:normal">select '      ' as 'password', d.dept_code, a.status_code, state, PIDM from account a join department_status d on (d.department_status_code = a.department_status_code) left join person p on (a.personID = p.personID) where username = ?</span>
</li>
</ol>
</li>
<li style="margin-left:31.43pt; padding-left:4.57pt">
<span style="font-style:normal">Skip account unless:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:normal">It has a PIDM</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:normal">The account state is VALID, DISABLED or DELETABLE </span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:normal">The account status code indicates it is a Student</span>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt; font-style:normal">
<span>Determine the Banner Dept Code and Level</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">deptAndLevel()</span>
</li>
</ol>
</li>
<li style="margin-left:31.43pt; padding-left:4.57pt">
<span style="font-style:normal; background-color:#ffff00">Skip any student where the pidm, DEPT CODE AND LEVEL already exist for a different username.</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:normal">select SYRACCS_ROWNUM from SYRACCS where SYRACCS_PIDM = ? and </span>
<span style="font-style:normal; background-color:#ffff00">SYRACCS_DEPT_CODE = ? and SYRACCS_LEVL_CODE = ?</span>
<span style="font-style:normal"> and SYRACCS_USERNAME != ?</span>
</li>
</ol>
</li>
<li style="margin-left:31.03pt; padding-left:4.97pt">
<span style="font-style:normal">Check if the username already exists</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:normal">select SYRACCS_ROWNUM, SYRACCS_ACCMAN_STATUS, SYRACCS_PIDM, SYRACCS_SIS_STATUS, SYRACCS_INIT_PASSWORD, </span>
<span style="font-style:normal; background-color:#ffff00">SYRACCS_DEPT_CODE, SYRACCS_LEVL_CODE</span>
<span style="font-style:normal"> from SYRACCS where SYRACCS_USERNAME = ?</span>
</li>
</ol>
</li>
<li style="margin-left:29.13pt; padding-left:6.87pt">
<span style="font-style:normal">If it doesn’t exist insert it:</span>
</li>
<li style="margin-left:31.43pt; padding-left:4.57pt">
<span style="font-style:normal">If it does exist AND </span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:67.35pt; padding-left:4.65pt">
<span style="font-style:normal">The PIDM matches AND</span>
</li>
<li style="margin-left:67.35pt; padding-left:4.65pt">
<span style="font-style:normal">The dept code has changed OR</span>
</li>
<li style="margin-left:67.35pt; padding-left:4.65pt">
<span style="font-style:normal">The level has changed OR</span>
</li>
<li style="margin-left:67.35pt; padding-left:4.65pt">
<span style="font-style:normal">The AccMan status not ‘A’ OR</span>
</li>
<li style="margin-left:67.35pt; padding-left:4.65pt">
<span style="font-style:normal">The SIS status is not ‘A’</span>
</li>
</ol>
</li>
<li style="margin-left:68pt; padding-left:4pt; font-style:normal">
<span>Update it</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>update SYRACCS set SYRACCS_USERNAME = ?, SYRACCS_ACCMAN_STATUS = ?, SYRACCS_PIDM = ?, SYRACCS_SIS_STATUS = ?, SYRACCS_INIT_PASSWORD = ?, </span>
<span style="background-color:#ffff00">SYRACCS_DEPT_CODE = ?, SYRACCS_LEVL_CODE = ?,</span>
<span> SYRACCS_ACTIVITY_DATE = SYSDATE where SYRACCS_ROWNUM = ?</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt; font-style:italic">
<span style="background-color:#ffff00">deptAndLevel()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; padding-left:4.57pt">
<span style="font-style:normal">Translate AccMan dept codes and levels to Banner equivalents</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:normal">If AccMan Status_Code ‘P’  use Banner level code ‘PG’ else use ‘UG’</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:normal">If AccMan dept code = ‘AF’ and Banner level code = ‘UG’ use Banner Dept Code = ‘JA’</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt; font-style:italic">
<span>prepare_allocate()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; padding-left:4.57pt">
<span style="font-style:normal">define SQL statements</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt; font-style:italic">
<span>finish_allocate()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; margin-bottom:10pt; padding-left:4.95pt; font-style:normal">
<span>release DB handles.</span>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795893">
<span style="font-family:Cambria; color:#365f91">Banner4person.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795894">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This script reads student information from the MAIL.BANNER_IMPORT table. </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">It parses each Student record it finds; for each record it finds it converts Banner reference information to its AccMan equivalent and then either inserts a new MAIL.PERSON record or updates an existing one.</span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795895">
<span style="font-family:Cambria; color:#4f81bd">In Pictures</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<img src="plugins/servlet/benryanconversion" width="624" height="600" alt="banner4personplSequenceDiagram.png" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline"/>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795896">
<span style="font-family:Cambria; color:#4f81bd">Examples</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">TBC</span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795897">
<span style="font-family:Cambria; color:#4f81bd">Depends On</span>
</a>
</h2>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Perl Packages</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Warnings</span>
</li>
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Strict</span>
</li>
<li style="margin-left:28.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">DBI</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Libraries</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">connect.pl</span>
</li>
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">studentPerson.pl</span>
</li>
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">paths.pl</span>
</li>
<li style="margin-left:28.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">trLogging.pl</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Database Tables</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">MAIL</span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; margin-bottom:10pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">BANNER_IMPORT</span>
</li>
</ul>
</li>
</ul>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795898">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Define local variables</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Connect to Banner database </span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">connectDB()</span>
<span> in </span>
<span style="font-weight:bold">connect.pl</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Define SQL handles to read students imported from Banner held in MAIL.BANNER_IMPORT</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; padding-left:4.57pt; font-style:italic">
<span style="font-style:normal">Via </span>
<span>PrepareSQL()</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Define SQL handles to read and write Student information</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">prepareStudentPersonSQL()</span>
<span> in </span>
<span style="font-weight:bold">studentPerson.pl</span>
<span>.</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Initialise reference data for Student Titles, States and Department code mappings</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">initialiseParsing()</span>
<span> in </span>
<span style="font-weight:bold">studentPerson.pl</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Import Student Information</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via</span>
<span style="font-style:italic"> importStudents()</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Record the start of the import process</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">generateImport()</span>
<span> in </span>
<span style="font-weight:bold">studentPerson.pl</span>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt">
<span>Read Student Information from MAIL.BANNER_IMPORT:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt; font-family:'Arial monospaced for SAP'">
<span>select SPRIDEN_PIDM, SPRIDEN_ID, SPRIDEN_LAST_NAME, SPRIDEN_FIRST_NAME, SPRIDEN_MI, SPBPERS_BIRTH_DATE, SPBPERS_SEX, SPBPERS_NAME_PREFIX, SGBSTDN_TERM_CODE_EFF, SGBSTDN_STST_CODE, </span>
<span style="background-color:#ffff00">SGBSTDN_LEVL_CODE</span>
<span>, SGBSTDN_STYP_CODE, SGBSTDN_DEGC_CODE_1, SGBSTDN_MAJR_CODE_1, SGBSTDN_BLCK_CODE, </span>
<span style="background-color:#ffff00">SGBSTDN_DEPT_CODE</span>
<span>, SGBSTDN_PROGRAM_1, SFBETRM_AR_IND, SFBETRM_ADD_DATE, SFBETRM_ESTS_CODE, SKBHINS_ENDDATE from banner_import</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>For each Student Record update AccMan Student Details</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">updateStudentDetails()</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Convert or reject a Student’s Personal Details from Banner to AccMan equivalents. E.g. tidy names, select AccMan person title and clean birth dates.</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Via </span>
<span style="font-style:italic">parsePerson()</span>
<span> in </span>
<span style="font-weight:bold">studentPerson.pl</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Convert or reject a Student’s Course Details from Banner to AccMan equivalents. E.g. determine student state, select AccMan department codes and set student codes.</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Via </span>
<span style="font-style:italic">parseCourse()</span>
<span> in </span>
<span style="font-weight:bold">studentPerson.pl</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Convert or reject a Student RegistrationDetails from Banner to AccMan equivalents. E.g. determine student registration state from enrolment status</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Via</span>
<span style="font-style:italic"> parseRegistration()</span>
<span> in</span>
<span style="font-weight:bold"> studentPerson.pl</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Adjust person state for Nursing UGs</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Log any rejected Students where their registration state is ‘present’ </span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Ignore any students with registration status = ‘EL’ or with an invalid Student Id. Update Student Information held in AccMan</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Via </span>
<span style="font-style:italic">updateStudentPerson()</span>
<span> in </span>
<span style="font-weight:bold">studentPerson.pl</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.25pt; padding-left:4.75pt">
<span>Record the completion of the import process.</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">completeImport()</span>
<span> in </span>
<span style="font-weight:bold">studentPerson.pl</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Close Student Information SQL handles </span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">finishStudentPersonSQL()</span>
<span>  in </span>
<span style="font-weight:bold">studentPerson.pl</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Disconnect from Banner database </span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; margin-bottom:10pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">finishDB()</span>
<span> in </span>
<span style="font-weight:bold">connect.pl</span>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795899">
<span style="font-family:Cambria; color:#365f91">Banner4Talis.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795900">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri">For students, generate Talis Borrower Import file from Accman data.</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri">Extracts selected data fields from all student account records in Accman </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795901">
<span style="font-family:Cambria; color:#4f81bd">In Pictures</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795902">
<span style="font-family:Cambria; color:#4f81bd">Examples</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795903">
<span style="font-family:Cambria; color:#4f81bd">Depends On</span>
</a>
</h2>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Perl Packages</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Warnings</span>
</li>
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Strict</span>
</li>
<li style="margin-left:28.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">DBI</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Modules</span>
</h3>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Tables</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">MAIL</span>
<span style="font-family:Calibri"> </span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PERSON_IMPORT</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PERSON</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">DEPT</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">ACCOUNT</span>
</li>
<li style="margin-left:29.6pt; margin-bottom:10pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">TRANSACTIONS</span>
</li>
</ul>
</li>
</ul>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795904">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Connect to AccMan Database</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">connect_db()</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Get the ID of the last successful Banner Import</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>select importID from person_import where source_code = 'S' and completed = 'Y' order by importID desc limit 1</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Open an export file</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Generate SQL statements</span>
</li>
<li style="margin-left:31.35pt; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Get a list of all imported students</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>select per.RealName, per.rollnumber, per.SPRIDEN_ID, per.person_status_code, per.forenames, per.title, per.</span>
<span style="background-color:#ffff00">dept_code</span>
<span>, per.leaver_flag, per.stu_att, </span>
<span style="background-color:#ffff00">dpt.site_code</span>
<span> from person per, dept dpt where per.dept_code = dpt.dept_code and per.importID = $importID and per.first_importID = $first_importID</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>For each Student</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; line-height:115%; padding-left:4.95pt">
<span>Get email address</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">get_email_address()</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; line-height:115%; padding-left:4.44pt">
<span>Get Talis status</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">get_talis_special_status()</span>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; line-height:115%; padding-left:5.57pt">
<span>Get Tails email optout</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">get_talis_email_optout()</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; line-height:115%; padding-left:4.44pt">
<span>Write the student information to the export file.</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; line-height:normal; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">print_borrower_type_id(),  print_expiry_date_future(), print_borrower_site(), print_borrower_surname(), print_borrower_title(), print_borrower_forenames(), print_borrower_department(), print_home_and_term_addresses(), print_borrower_registration_number(), print_email_address()</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Get a list of all students who have had their NDS accounts have been disabled recently.</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>select per.RealName, per.rollnumber, per.SPRIDEN_ID, per.person_status_code, per.forenames, per.title</span>
<span style="background-color:#ffff00">, per.dept_code</span>
<span>, per.leaver_flag, per.stu_att, </span>
<span style="background-color:#ffff00">dpt.site_code</span>
<span> from person per, </span>
<span style="background-color:#ffff00">dept dpt</span>
<span>, account acc, transactions tx where per.dept_code = dpt.dept_code and acc.personID = per.personID and acc.status_code &lt; 'R' and tx.affectsID = acc.accID and tx.tr_type_id = 12 and tx.tr_state = 'processed' and tx.tr_when &gt;= '$first_date_string'</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>For each Student</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>If it has already been processed by the code above then skip it.</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select per.RealName, per.rollnumber, per.SPRIDEN_ID, per.person_status_code, per.forenames, per.title, </span>
<span style="background-color:#ffff00">per.dept_code</span>
<span>, per.leaver_flag, per.stu_att, dpt.site_code from person per, dept dpt where </span>
<span style="background-color:#ffff00">per.dept_code = dpt.dept_code</span>
<span> and per.importID = $importID and per.first_importID = $first_importID and per.rollnumber = ?</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Get email address</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">get_email_address()</span>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt">
<span>Get Talis status</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">get_talis_special_status()</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Get Tails email optout</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">get_talis_email_optout()</span>
</li>
</ol>
</li>
<li style="margin-left:31.25pt; padding-left:4.75pt">
<span>Write the student information to the export file.</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; line-height:normal; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">print_borrower_type_id(),  print_expiry_date_future(), print_borrower_site(), print_borrower_surname(), print_borrower_title(), print_borrower_forenames(), print_borrower_department(), print_home_and_term_addresses(), print_borrower_registration_number(), print_email_address()</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Disconnect from AccMan Database</span>
<ol start="5" type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.25pt; margin-bottom:10pt; padding-left:4.75pt">
<span>Vi </span>
<span style="font-style:italic">disconnect_DB()</span>
<span> in </span>
<span style="font-weight:bold">connect.pl</span>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795905">
<span style="font-family:Cambria; color:#365f91">deDuplicateWeekly.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795906">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri">Disable all valid personal student accounts where person has left</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri">Disable all personal student accounts in the wrong school or at the wrong level (provided the student has a valid account at the correct school and level)</span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795907">
<span style="font-family:Cambria; color:#4f81bd">In Pictures</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795908">
<span style="font-family:Cambria; color:#4f81bd">Examples</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795909">
<span style="font-family:Cambria; color:#4f81bd">Depends On</span>
</a>
</h2>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Perl Packages</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Warnings</span>
</li>
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Strict</span>
</li>
<li style="margin-left:28.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">DBI</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Modules</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Connect.pl</span>
</li>
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">disableAccount.pl</span>
</li>
<li style="margin-left:28.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">paths.pl</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Tables</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">MAIL</span>
<span style="font-family:Calibri"> </span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PERSON</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">ACCOUNT</span>
</li>
<li style="margin-left:29.6pt; margin-bottom:10pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">DEPARTMENT_STATUS</span>
</li>
</ul>
</li>
</ul>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795910">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<ol start="6" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Connect to AccMan database</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.37pt; padding-left:4.63pt; font-weight:bold">
<span style="font-weight:normal">Via connectDB() in </span>
<span>connect.pl</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Prepare SQL statements</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">prepare_SQL()</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Disable accounts for students who have left</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">disableLeft()</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Read  list of students who have left</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select a.accID, a.username from person p, account a where p.personID = a.personID and p.source_code = 'S' and p.person_state in ('left', 'missing') and a.state = 'valid' and a.accountType = 'personal'</span>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt">
<span>Disable the account of each student who has left.</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt; font-weight:bold">
<span style="font-weight:normal">Vai </span>
<span style="font-weight:normal; font-style:italic">disableAccount</span>
<span style="font-weight:normal">() in </span>
<span>disableAccount.pl</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Disable duplicate accounts for students who have moved school/level</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; padding-left:4.57pt; font-style:italic">
<span style="font-style:normal">Via </span>
<span>disableDuplicates()</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Read a list of students who have duplicate accounts where one has the wrong dept/level</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select a1.username, a2.accID, a2.username from person p, account a1, account a2, </span>
<span style="background-color:#ffff00">department_status</span>
<span> ds1, </span>
<span style="background-color:#ffff00">department_status</span>
<span> ds2 where p.personID = a1.personID and p.personID = a2.personID and </span>
<span style="background-color:#ffff00">a1.department_status_code = ds1.department_status_code</span>
<span> and </span>
<span style="background-color:#ffff00">a2.department_status_code = ds2.department_status_code</span>
<span> and p.source_code = 'S' and a1.state = 'valid' and a1.accountType = 'personal' and a2.accID != a1.accID and a2.accountType = 'personal' and ds1.dept_code = </span>
<span style="background-color:#ffff00">p.dept_code</span>
<span> and ((p.person_status_code in ('U', 'N') and a1.status_code &lt; 'P') or (p.person_status_code = 'P' and a1.status_code = 'P')) and (</span>
<span style="background-color:#ffff00">ds2.dept_code != p.dept_code</span>
<span> or (p.person_status_code in ('U', 'N') and a2.status_code = 'P') or (p.person_status_code = 'P' and a2.status_code &lt; 'P')) and (a2.state = 'valid' or (a2.state = 'disabled' and (a2.disabledReason in ('Student has left', 'Student is absent', 'User has left - extension expired', 'Student has probably left') or (a2.disabledReason like 'Now using%' and a2.disabledReason != concat('Now using ', a1.username)) or a2.disabledReason like 'Already using%')))</span>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt">
<span>Disable each duplicate account.</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt; font-weight:bold">
<span style="font-weight:normal">Via </span>
<span style="font-weight:normal; font-style:italic">disableAccount</span>
<span style="font-weight:normal">() in </span>
<span>disableAccount.pl</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Disconnect from AccMan database</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; margin-bottom:10pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">disconnectDB()</span>
<span> in </span>
<span style="font-weight:bold">connect.pl</span>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795911">
<span style="font-family:Cambria; color:#365f91">DisableAccount.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795912">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795913">
<span style="font-family:Cambria; color:#4f81bd">In Pictures</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795914">
<span style="font-family:Cambria; color:#4f81bd">Examples</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795915">
<span style="font-family:Cambria; color:#4f81bd">Depends On</span>
</a>
</h2>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Perl Packages</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Warnings</span>
</li>
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Strict</span>
</li>
<li style="margin-left:10.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">DBI</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Libraries</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">connect.pl</span>
</li>
<li style="margin-left:10.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">generateTransaction.pl</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Transactions</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">12</span>
</li>
<li style="margin-left:10.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">62</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Database Tables</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">MAIL</span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">ACCOUNT</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">ACCOUNT_DETAILS</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">DEPARTMENT_STATUS</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">EMAIL_DOMAIN</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PERSON</span>
</li>
<li style="margin-left:29.6pt; margin-bottom:10pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">STUDENT_ESTS</span>
</li>
</ul>
</li>
</ul>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795916">
<span style="font-family:Cambria; color:#4f81bd">Methods</span>
</a>
</h2>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span style="font-style:italic">disableAccount()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Get Account State</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select state from account where accID = ?</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Stop processing if the account does not exist or the state is one of:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>deleted, invalid</span>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt">
<span>Convert account state to disabled, failed, expired, deletable or deleting or NULL</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>If account state is not NULL</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Update the account record disabling the account:</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>update account set state = ?, disabledReason = ?, disabledCure = ? where accID = ?</span>
<span>              </span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.25pt; padding-left:4.75pt">
<span>Update the account details</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>update account_details set disabled = 'Y', disdate = now() where accID = ? and (disabled != 'Y' or disdate is null)</span>
</li>
</ol>
</li>
<li style="margin-left:29.13pt; padding-left:6.87pt">
<span>Create an Disabling, type </span>
<span style="background-color:#00ff00">12</span>
<span>, Transaction with parameters:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select username, defaultContext context, disabledReason from account a, </span>
<span style="background-color:#ffff00">department_status</span>
<span> d where </span>
<span style="background-color:#ffff00">a.department_status_code = d.department_status_code</span>
<span> and accID = ?</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>via </span>
<span style="font-style:italic">generateTransaction()</span>
<span> in </span>
<span style="font-weight:bold">generateTransaction.pl</span>
</li>
</ol>
</li>
<li style="margin-left:30.95pt; padding-left:5.05pt">
<span>Create an Disable Live@Edu account, type </span>
<span style="background-color:#00ff00">62</span>
<span>, Transaction with parameters:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select concat(a.primary_mailname, '@', ed.domainName) identity from account a, emailDomain ed where a.primary_domainID = ed.domainID and accID = ?</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>via </span>
<span style="font-style:italic">generateTransaction()</span>
<span> in </span>
<span style="font-weight:bold">generateTransaction.pl</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Close Database handles</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; margin-bottom:10pt; padding-left:4pt">
<span>Via</span>
<span style="font-style:italic"> finishDB()</span>
<span> in </span>
<span style="font-weight:bold">connect.pl</span>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795917">
<span style="font-family:Cambria; color:#365f91">EnableAccount.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795918">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795919">
<span style="font-family:Cambria; color:#4f81bd">In Pictures</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795920">
<span style="font-family:Cambria; color:#4f81bd">Examples</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795921">
<span style="font-family:Cambria; color:#4f81bd">Depends On</span>
</a>
</h2>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Perl Packages</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Warnings</span>
</li>
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Strict</span>
</li>
<li style="margin-left:10.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">DBI</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Libraries</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">connect.pl</span>
</li>
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">generateTransaction.pl</span>
</li>
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">trLogging.pl </span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; margin-bottom:10pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri; font-weight:bold">Indirectly referenced</span>
</li>
</ul>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Database Tables</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">MAIL</span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">ACCOUNT</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">DEPARTMENT_STATUS</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">DEPT_PERSON_ACCOUNT</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PERSON</span>
</li>
<li style="margin-left:29.6pt; margin-bottom:10pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">STUDENT_ESTS</span>
</li>
</ul>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Transactions</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">13</span>
</li>
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">33</span>
</li>
<li style="margin-left:10.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">63</span>
</li>
</ul>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795922">
<span style="font-family:Cambria; color:#4f81bd">Methods</span>
</a>
</h2>
<ol start="2" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Get Username and information about why the account is currently disabled.</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>select username, DisabledReason, DisabledCure from account where accID = ?</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Log information</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via apb_logactivity_tofile() in trLogging.pl</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Get Account State</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>select state from account where accID = ?</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Stop processing if the account state is one of:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>deleted, deleting or invalid</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Convert account state to valid, used, new or NULL</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Check reason account is disabled.</span>
</li>
<li style="margin-left:31.35pt; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Allow enabling if reason is one of:</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Undefined</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Blank</span>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt">
<span>Student is absent</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Student has left</span>
</li>
<li style="margin-left:31.25pt; padding-left:4.75pt">
<span>User has left - extension expired</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Do </span>
<span style="font-weight:bold">not</span>
<span> allow enabling if the reason is one of:</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Now using…</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Account moved to…</span>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt">
<span>Anything else</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>If this was called from </span>
<span style="font-weight:bold">enable.pl</span>
<span> override any earlier logic to allow enabling.</span>
</li>
<li style="margin-left:36pt; font-family:Calibri; font-size:11pt">
<span>If the account has been manually blocked then prevent any disabling</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>select manually_disabled from account where accID = ?</span>
</li>
</ol>
</li>
<li style="margin-left:36pt; font-family:Calibri; font-size:11pt">
<span>If the account can be enabled</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Update the account state</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>update account set state = ?, disabledReason = null, disabledCure = null where accID = ?</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Update the account details</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>update account_details set disabled = 'N', disdate = null where accID = ? and (disabled != 'N' or disdate is not null)</span>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt">
<span>Create an ExpiryDate, type 33, Transaction with parameters dependent on the Account state</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select username, defaultContext context, 'none' as 'date’  from account a, department_status d where a.department_status_code = d.department_status_code and accID = ?</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>OR</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>select username, defaultContext context, date_add(curdate(), interval 1 month) as 'date' from account a, department_status d where a.department_status_code = d.department_status_code and accID = ?</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">generateTransaction()</span>
<span> in generateTransaction.pl</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Create a ???????, type 13, Transaction with parameters dependent a optional Reason</span>
<span>              </span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select username, defaultContext context from account a, department_status d where a.department_status_code = d.department_status_code and accID = ?</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>OR</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>select username, defaultContext context, '$reason' as enabledReason from account a, department_status d where a.department_status_code = d.department_status_code and accID = ?</span>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<ol type="i" style="margin:0pt; padding-left:0pt">
<li style="margin-left:104pt; padding-left:13pt; font-family:Calibri; font-size:11pt">
<span>Via </span>
<span style="font-style:italic">generateTransaction()</span>
<span> in generateTransaction.pl</span>
<ol start="5" type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:-49.75pt; padding-left:4.75pt">
<span>Create an Enable Live@Edu account, type 63, Transaction with parameters </span>
<span style="width:5.95pt; display:inline-block"/>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select concat(a.primary_mailname, '@', ed.domainName) identity from account a, emailDomain ed where a.primary_domainID = ed.domainID and accID = ?</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">generateTransaction()</span>
<span> in generateTransaction.pl</span>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<ol start="12" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:36pt; font-family:Calibri; font-size:11pt">
<span>Close Database handles</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.37pt; padding-left:4.63pt; font-weight:bold">
<span style="font-weight:normal">Via finishDB() in </span>
<span>connect.pl</span>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-left:108pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795923">
<span style="font-family:Cambria; color:#365f91">EnableDisable.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795924">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795925">
<span style="font-family:Cambria; color:#4f81bd">In Pictures</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795926">
<span style="font-family:Cambria; color:#4f81bd">Examples</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795927">
<span style="font-family:Cambria; color:#4f81bd">Depends On</span>
</a>
</h2>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Perl Packages</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Warnings</span>
</li>
<li style="margin-left:10.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">DBI</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Libraries</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">mailAccount.pl</span>
</li>
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">generateTransaction.pl</span>
</li>
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">trCommon.pl</span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; margin-bottom:10pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri; font-weight:bold">implicitly referenced</span>
</li>
</ul>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Database Tables</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">MAIL</span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">ACCOUNT</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">EMAILDOMAIN</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">MAILSERVERS</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">ACCOUNT_DETAILS</span>
</li>
</ul>
</li>
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">IDM/IDMDEV</span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">MAIL_DOMAIN</span>
</li>
<li style="margin-left:29.6pt; margin-bottom:10pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">MAIL_ACCOUNT</span>
</li>
</ul>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Transactions</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">103</span>
</li>
<li style="margin-left:10.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">104</span>
</li>
</ul>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795928">
<span style="font-family:Cambria; color:#4f81bd">Methods</span>
</a>
</h2>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt; font-family:Calibri; font-size:11pt; font-style:italic">
<span>prepare_specific_SQL()</span>
</li>
<li style="margin-left:31.35pt; padding-left:4.65pt; font-family:Calibri; font-size:11pt; font-style:italic">
<span>specificInitialisation()</span>
</li>
<li style="margin-left:31.35pt; padding-left:4.65pt; font-family:Calibri; font-size:11pt; font-style:italic">
<span>transaction()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt; font-style:normal">
<span>Check username is valid</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt; font-weight:bold">
<span style="font-weight:normal">Via </span>
<span style="font-weight:normal; font-style:italic">checkParam_username</span>
<span style="font-weight:normal">() in </span>
<span>trCommon.pl</span>
</li>
</ol>
</li>
<li style="margin-left:31.84pt; padding-left:4.16pt; font-weight:bold; font-style:normal">
<span style="font-weight:normal">Update the email account</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-weight:normal">Via </span>
<span style="font-weight:normal; font-style:italic">updateEmailAccount()</span>
<span style="font-weight:normal"> in </span>
<span>mailAccount.pl</span>
</li>
<li style="margin-left:32pt; padding-left:4pt; font-weight:normal">
<span>Select the current email information for the Student</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>SELECT  A.USERNAME,  'ACCMAN' AS 'DATA_SOURCE',  P.DEPT_CODE,  P.TITLE,  P.REALNAME,  P.FORENAMES,   P.PREFERREDNAME,  P.INITIALS,  P.PERSON_STATUS_CODE,  IF(AD.DELETED = 'Y', 'DELETED', IF(A.STATE = 'VALID' AND AD.DISABLED = 'N', 'VALID', 'DISABLED')) AS MAIL_STATUS,  IF(A.DISPOSE_DOMAINID = 266, 'LIVE\@EDU', IF(A.DISPOSE_DOMAINID = 5, 'LIVE\@EDU', IF(A.DISPOSE_DOMAINID = 183, 'WEBMAIL',  IF(A.DISPOSE_DOMAINID = 178, 'EXCHANGE', 'POP3')))) AS MAIL_TYPE,  A.DISPOSE_MAILNAME, ID1.DOMAIN_ID,  IF(A.DISPOSE_DOMAINID != 178, AD.PASSWORD, NULL) AS MAILBOX_PASSWORD, ID2.DOMAIN_ID,  IF(A.DISPOSE_DOMAINID = 183,    CONCAT(M.MAILDIR, '/', LEFT(DISPOSE_MAILNAME, 1), '/', MID(DISPOSE_MAILNAME, 2, 1), '/', MID(DISPOSE_MAILNAME, 3, 1), '/', MID(DISPOSE_MAILNAME, 4, 1), '/',  ID(DISPOSE_MAILNAME, 5, 1), '/', MID(DISPOSE_MAILNAME, 6, 1)),   IF(A.DISPOSE_DOMAINID != 178, CONCAT(M.MAILDIR, '/', LEFT(DISPOSE_MAILNAME, 2), '/', MID(DISPOSE_MAILNAME, 3, 1), '/', DISPOSE_MAILNAME),    NULL)) AS PATH,  IF(A.DISPOSE_DOMAINID != 178, AD.FSQUOTA, NULL) AS QUOTA FROM   PERSON P  JOIN ACCOUNT A ON P.PERSONID = A.PERSONID  JOIN EMAILDOMAIN E ON A.DISPOSE_DOMAINID = E.DOMAINID  JOIN $IDMDB\.MAIL_DOMAIN ID1 ON E.DOMAINNAME = ID1.DOMAIN_NAME  LEFT JOIN MAILSERVERS M ON A.MAILSERVERID = M.MAILSERVERID  LEFT JOIN $IDMDB\.MAIL_DOMAIN ID2 ON M.SERVERNAME = ID2.DOMAIN_NAME  JOIN ACCOUNT_DETAILS AD ON A.ACCID = AD.ACCID WHERE  AD.TYPE = 'EMAIL' AND  A.USERNAME = ?</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt; font-weight:normal">
<span>Update the Students account</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>UPDATE $IDMDB\.MAIL_ACCOUNT SET USERNAME = ?, DATA_SOURCE = ?, DEPT_CODE = ?, TITLE = ?, SURNAME = ?, FIRST_NAMES = ?, PREFERRED_NAME = ?, INITIALS = ?, USER_STATUS_CODE = ?, MAIL_STATUS = ?, MAIL_TYPE = ?, DELIVERY_NAME = ?, DELIVERY_DOMAIN_ID = ?, MAILBOX_PASSWORD = ?, MAILBOX_DOMAIN_ID = ?, MAILBOX_LOCATION = ?, MAILBOX_QUOTA = ? WHERE USERNAME = ?</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:30.54pt; padding-left:5.46pt; font-weight:bold; font-style:normal">
<span style="font-weight:normal">Check context is valid</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-weight:normal">Via </span>
<span style="font-weight:normal; font-style:italic">checkParam_context()</span>
<span style="font-weight:normal"> in </span>
<span>trCommon.pl</span>
</li>
</ol>
</li>
<li style="margin-left:31.84pt; padding-left:4.16pt; font-weight:bold; font-style:normal">
<span style="font-weight:normal">If disabling, type 12</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-weight:normal">Create a Disable AD Account, type 103, Transaction</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.51pt; padding-left:4.49pt">
<span style="font-weight:normal">Via </span>
<span style="font-weight:normal; font-style:italic">generateTransaction()</span>
<span style="font-weight:normal"> in </span>
<span>generateTransaction.pl</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.48pt; padding-left:4.52pt; font-weight:bold; font-style:normal">
<span style="font-weight:normal">If enabling, type 13</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-weight:normal">Create a Ensable AD Account, type 104, Transaction</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt; font-weight:normal">
<span>Via </span>
<span style="font-style:italic">generateTransaction()</span>
<span> in </span>
<span style="font-weight:bold">generateTransaction.pl</span>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795929">
<span style="font-family:Cambria; color:#365f91">restoreUFAA.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795930">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri">Restore future UFAA status for students after they have left in this session</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri">Restore present/future UFAA status for students after they have left in previous session</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri">Restore UFAA status for students after being erroneously assigned an account for a school/level they are not studying in ( =&gt; acad_sess = 0000)</span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795931">
<span style="font-family:Cambria; color:#4f81bd">In Pictures</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795932">
<span style="font-family:Cambria; color:#4f81bd">Examples</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795933">
<span style="font-family:Cambria; color:#4f81bd">Depends On</span>
</a>
</h2>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Perl Packages</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Warnings</span>
</li>
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Strict</span>
</li>
<li style="margin-left:28.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">DBI</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Modules</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Connect.pl</span>
</li>
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Paths.pl</span>
</li>
<li style="margin-left:28.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">trLogging.pl</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Tables</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">MAIL</span>
<span style="font-family:Calibri"> </span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PERSON</span>
</li>
</ul>
</li>
<li style="margin-left:28.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">BANNER</span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">SGBSTDN</span>
</li>
<li style="margin-left:29.6pt; margin-bottom:10pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">SYRACCS</span>
</li>
</ul>
</li>
</ul>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795934">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<ol start="10" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Connect to AccMan Database</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">ConnectAccman()</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Vi </span>
<span style="font-style:italic">ConnectDB()</span>
<span> in </span>
<span style="font-weight:bold">connect.pl</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Connect to Banner Database</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">ConnectBanner()</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Vi </span>
<span style="font-style:italic">ConnectDB()</span>
<span> in </span>
<span style="font-weight:bold">connect.pl</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Prepare SQL Statements</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">prepareSQL()</span>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Restore UFAA status in the </span>
<span style="font-weight:bold">next</span>
<span> session for students who left in the</span>
<span style="font-weight:bold"> current</span>
<span> session</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; padding-left:4.57pt; font-style:italic">
<span style="font-style:normal">Via </span>
<span>restoreUFAA()</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Find all students who left in the relevant session</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select PIDM, program from person where source_code = 'S' and acad_sess = ? and person_state = 'left'</span>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt">
<span>For each student check if they are still active in banner for target session on a new or different dept.</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select </span>
<span style="background-color:#ffff00">SGBSTDN_DEPT_CODE</span>
<span>, </span>
<span style="background-color:#ffff00">SGBSTDN_LEVL_CODE,</span>
<span> SGBSTDN_TERM_CODE_EFF from SGBSTDN where SGBSTDN_TERM_CODE_EFF &gt; ? and SGBSTDN_TERM_CODE_ADMIT &gt; ? and SGBSTDN_STST_CODE = 'AS' and SGBSTDN_PROGRAM_1 != ? and SGBSTDN_PIDM = ?</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>If they are re-assign the account</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>update SYRACCS set SYRACCS_ACCMAN_STATUS = 'R', SYRACCS_ACTIVITY_DATE = SYSDATE where SYRACCS_PIDM = ? and </span>
<span style="background-color:#ffff00">SYRACCS_DEPT_CODE = ? and SYRACCS_LEVL_CODE = ?</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Restore UFAA status in the </span>
<span style="font-weight:bold">current</span>
<span> session for students who left in the </span>
<span style="font-weight:bold">last</span>
<span> session</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; padding-left:4.57pt; font-style:italic">
<span style="font-style:normal">Via </span>
<span>restoreUFAA()</span>
<span style="font-style:normal"> see above</span>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Restore UFAA status in the </span>
<span style="font-weight:bold">current</span>
<span> session for students in the wrong dept/level</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; padding-left:4.57pt; font-style:italic">
<span style="font-style:normal">Via </span>
<span>restoreUFAA() </span>
<span style="font-style:normal">see above</span>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Disconnect from Banner Database</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">disconnectBanner()</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Vi </span>
<span style="font-style:italic">disconnectDB()</span>
<span> in </span>
<span style="font-weight:bold">connect.pl</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Disconnect from AccMan Database</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">disconnectAccman()</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; margin-bottom:10pt; padding-left:4pt">
<span>Vi </span>
<span style="font-style:italic">disconnectDB()</span>
<span> in </span>
<span style="font-weight:bold">connect.pl</span>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795935">
<span style="font-family:Cambria; color:#365f91">StudentAutoState.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795936">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795937">
<span style="font-family:Cambria; color:#4f81bd">In Pictures</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795938">
<span style="font-family:Cambria; color:#4f81bd">Examples</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795939">
<span style="font-family:Cambria; color:#4f81bd">Depends On</span>
</a>
</h2>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Perl Packages</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Warnings</span>
</li>
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Strict</span>
</li>
<li style="margin-left:10.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">DBI</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Libraries</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">connect.pl</span>
</li>
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">disableAccount.pl</span>
</li>
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">enableAccount.pl</span>
</li>
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">trLogging.pl</span>
</li>
<li style="margin-left:10.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">paths.pl</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Database Tables</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">MAIL</span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">ACCOUNT</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">DEPARTMENT_STATUS</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">DEPT_PERSON_ACCOUNT</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PERSON</span>
</li>
<li style="margin-left:29.6pt; margin-bottom:10pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">STUDENT_ESTS</span>
</li>
</ul>
</li>
</ul>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795940">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<ol start="9" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Define local variables</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Define the current academic session year</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Optionally decrement the year by 1.</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Connect to Banner database </span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">connectDB()</span>
<span> in </span>
<span style="font-weight:bold">connect.pl</span>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Define SQL handles to read persons Account, Person, Department and status information, based on the current academic session.</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; padding-left:4.57pt; font-style:italic">
<span style="font-style:normal">Via </span>
<span>PrepareSQL()</span>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Find the most recent Person Import </span>
<span style="font-weight:bold">NOT USED</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>select importID from person_import where source_code = 'S' and completed = 'Y' order by importID desc limit 1</span>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Enable accounts for returning students</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; padding-left:4.57pt; font-style:italic">
<span style="font-style:normal">Via </span>
<span>enable()</span>
</li>
<li style="margin-left:31.43pt; padding-left:4.57pt; font-style:italic">
<span style="font-style:normal">Get all details about accounts potentially to be enabled.</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:normal">Filter by current academic year and defined account and person states, status codes, dept codes and reasons for disabling the account.</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span style="font-style:normal">select a.accID, a.username, p.person_state, p.personID from account a, person p, department_status ds, dept_person_account d where p.personID = a.personID and p.person_state in ('present', 'graduating') and p.source_code = 'S' and p.acad_sess &gt;= $session and ((p.person_status_code in ('N', 'U') and a.status_code &lt; 'P') or (p.person_status_code = 'P' and a.status_code in ('P', 'Q'))) and a.state in ('disabled', 'deletable') and a.accountType = 'personal' and a.department_status_code = ds.department_status_code and p.dept_code = d.person_dept_code and ds.dept_code = d.account_dept_code and a.disabledReason in ('$leftReason', '$absentReason', '$extendReason', 'Student has probably left')</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt">
<span>For each Account</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Check if the account is currently valid:</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>select a.username from account a, person p, department_status ds, dept_person_account d where p.personID = ? and p.personID = a.personID and ((p.person_status_code in ('N', 'U') and a.status_code &lt; 'P') or (p.person_status_code = 'P' and a.status_code in ('P', 'Q'))) and a.state = 'valid' and a.accountType = 'personal' and a.department_status_code = ds.department_status_code and p.dept_code = d.person_dept_code and ds.dept_code = d.account_dept_code and a.accID != ?</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>If there is a valid account disable it.</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">disableAccount()</span>
<span> in </span>
<span style="font-weight:bold">disableAccount.pl</span>
</li>
</ol>
</li>
<li style="margin-left:31.25pt; padding-left:4.75pt">
<span>If the current account is not valid enable it.</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">enableAccount()</span>
<span> in </span>
<span style="font-weight:bold">enableAccount.pl</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Log the change</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Via </span>
<span style="font-style:italic">apb_logactivity_tofile()</span>
<span> in </span>
<span style="font-weight:bold">trLogging.pl</span>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Disable accounts for departed of inactive students</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Get Cure codes, </span>
<span>%cure</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">getCurehash</span>
<span>()</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>select stu_ests, ests_desc, person_state from student_ests</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.43pt; padding-left:4.57pt; font-style:italic">
<span style="font-style:normal">Get all details about accounts to be disabled.</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:normal">Filter by current academic year and defined account and person types, states, source codes, dept codes and session.</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt; font-style:normal">
<span>select a.accID, a.username, p.person_state, p.stu_ests from account a, person p, department_status ds where p.personID = a.personID and p.person_state in ('absent', 'left') and p.source_code = 'S' and p.acad_sess &gt;= $session and a.state = 'valid' and a.accountType = 'personal' and a.department_status_code = ds.department_status_code</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt; font-style:normal">
<span>Disable the account </span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Via </span>
<span style="font-style:italic">disableAccount()</span>
<span> in </span>
<span style="font-weight:bold">disableAccount.pl</span>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Log counts of accounts processed.</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Via </span>
<span>logactivity() and apb_logactivity_tofile() in </span>
<span style="font-weight:bold">trLogging.pl</span>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Disconnect from Banner</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; margin-bottom:10pt; padding-left:4.95pt">
<span>Via </span>
<span style="font-style:italic">disconnectDB()</span>
<span> in </span>
<span style="font-weight:bold">connect.pl</span>
</li>
</ol>
</li>
</ol>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<span style="font-family:Cambria; color:#365f91"> </span>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795941">
<span style="font-family:Cambria; color:#365f91">StudentPerson.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795942">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795943">
<span style="font-family:Cambria; color:#4f81bd">In Pictures</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795944">
<span style="font-family:Cambria; color:#4f81bd">Examples</span>
</a>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795945">
<span style="font-family:Cambria; color:#4f81bd">Depends On</span>
</a>
</h2>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Perl Packages</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Warnings</span>
</li>
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">Strict</span>
</li>
<li style="margin-left:10.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">DBI</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Libraries</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">connect.pl</span>
</li>
<li style="margin-left:10.06pt; margin-bottom:10pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri; font-weight:bold">generateTransaction.pl</span>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Database Tables</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; line-height:115%; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">MAIL</span>
<ul type="circle" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">TITLEMAP</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">STUDENT_ESTS</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">BANNER_DEPT</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">SY_TO_EL_PROGRAM_CODES</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PERSON_IMPORT</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">BANNER_IMPORT</span>
<ul type="square" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:28.03pt; padding-left:7.97pt; -aw-font-family:'Wingdings'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">(indirectly as values from this are passed into the functions)</span>
</li>
</ul>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PERSON</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PERSON_ADD</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">EXTENSION</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PERSON_REJECTED_DATA</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PERSON_CHANGE</span>
</li>
<li style="margin-left:29.6pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">PROG</span>
</li>
<li style="margin-left:29.6pt; margin-bottom:10pt; padding-left:6.4pt; -aw-font-family:'Courier New'; -aw-font-weight:normal; -aw-number-format:'o'">
<span style="font-family:Calibri">MIDYEARPROG</span>
</li>
</ul>
</li>
</ul>
<h3 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<span style="font-family:Cambria; color:#4f81bd">Transactions</span>
</h3>
<ul type="disc" style="margin:0pt; padding-left:0pt">
<li style="margin-left:10.06pt; padding-left:7.94pt; font-family:serif; font-size:11pt; -aw-font-family:'Symbol'; -aw-font-weight:normal; -aw-number-format:''">
<span style="font-family:Calibri">97:</span>
<span style="font-family:Verdana; font-size:6.5pt"> </span>
<span style="font-family:Calibri">UPDATE_JANUS_USER_DETAILS (.NET)</span>
</li>
</ul>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795946">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<ol start="17" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span>Update Person</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>As implemented in </span>
<span style="font-style:italic">Banner4Person.pl</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:italic">prepareStudentPersonSQL()</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:italic">initialiseParsing()</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:italic">generateImportID()</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>For each Student record in MAIL.BANNER_IMPORT</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt; font-style:italic">
<span>parsePerson()</span>
</li>
<li style="margin-left:31.35pt; padding-left:4.65pt; font-style:italic">
<span>parseCourse()</span>
</li>
<li style="margin-left:31.35pt; padding-left:4.65pt; font-style:italic">
<span>parseRegistration()</span>
</li>
<li style="margin-left:31.35pt; padding-left:4.65pt; font-style:italic">
<span>updateStudentPerson()</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:italic">completeImport()</span>
</li>
<li style="margin-left:32pt; margin-bottom:10pt; padding-left:4pt">
<span style="font-style:italic">finishStudentPersonSQL()</span>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795947">
<span style="font-family:Cambria; color:#4f81bd">Methods</span>
</a>
</h2>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Initialization</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; padding-left:4.57pt; font-style:italic">
<span>@graduationDate</span>
</li>
<li style="margin-left:31.43pt; padding-left:4.57pt; font-style:italic">
<span style="font-style:normal">%psc</span>
</li>
<li style="margin-left:30.35pt; padding-left:5.65pt; font-style:italic">
<span style="font-style:normal">%pgr</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span style="font-style:italic">prepareStudentPersonSQL()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Defines SQL Statements used in the following methods.</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span style="font-style:italic">initialiseParsing()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Initialises the AccMan person reference data, by calls to:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:italic">getTitleHash</span>
<span>()</span>
</li>
<li style="margin-left:32pt; padding-left:4pt; font-style:italic">
<span>getPStateHash()</span>
</li>
<li style="margin-left:32pt; padding-left:4pt; font-style:italic">
<span>getDeptHash()</span>
</li>
<li style="margin-left:32pt; padding-left:4pt; font-style:italic">
<span>getSYdeptHash()</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:italic">finishDB</span>
<span>() in </span>
<span style="font-weight:bold">connect.pl</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span style="font-style:italic">getTitleHash</span>
<span>()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>initialises map of person titles, </span>
<span style="font-style:italic">$titleMap</span>
<span>, </span>
<span> using:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select title, source_title from titleMap</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt; font-style:italic">
<span>getPStateHash()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt; font-style:normal">
<span>initialises a map of person states,</span>
<span> %pstate,</span>
<span> using:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select stu_ests, person_state from student_ests</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt; font-style:italic">
<span style="background-color:#ffff00">getDeptHash()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt; font-style:normal">
<span style="background-color:#ffff00">initialises a map of Banner Depts codes,</span>
<span style="background-color:#ffff00"> $depthash, </span>
<span style="background-color:#ffff00"> to AccMan codes using:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="background-color:#ffff00">select SGBSTDN_DEPT_CODE, dept_code from banner_dept</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt; font-style:italic">
<span style="background-color:#ffff00">getSYdeptHash()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt; font-style:normal">
<span style="background-color:#ffff00">initialises a map of obsolete SY Banner chemistry codes,</span>
<span style="background-color:#ffff00"> %SYdepthash,</span>
<span style="background-color:#ffff00"> using:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="background-color:#ffff00">select program from SY_to_EL_program_codes</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt; font-style:italic">
<span>generateImportID()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt; font-style:normal">
<span>Creates a new record in the MAIL.PERSON_IMPORT table and returns the ID value of the new record, using:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>insert into person_import (source_code) values ('S')</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt; font-style:italic">
<span>completeImport()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; padding-left:4.57pt">
<span style="font-style:normal">Signals the import is complete by updates the MAIL.PERSON_IMPORT record, using:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span style="font-style:normal">update person_import set completed = 'Y' where importID = ?</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt; font-style:italic">
<span>parsePerson()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt; font-style:normal">
<span>Check and convert Personal Details from Banner to AccMan equivalents.</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt; font-style:normal">
<span>Rejects the student if:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Student ID, </span>
<span>SPRIDEN_ID, </span>
<span> is invalid</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Student last name </span>
<span>SPRIDEN_LAST_NAME is invalid.</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Student first name </span>
<span>SPRIDEN_FIRST_NAME is invalid.</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Student middle name </span>
<span>SPRIDEN_MI is invalid.</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Student title, </span>
<span>SPBPERS_NAME_PREFIX, </span>
<span> cannot be mapped to AccMan</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Date of birth, </span>
<span style="font-family:Verdana; font-size:8pt">SPBPERS_BIRTH_DATE, </span>
<span> is invalid.</span>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt; font-style:normal">
<span>Record any rejections:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>insert into person_rejected_data (importID, rollnumber, field_name, bad_field_value) values (?, ?, ?, ?)</span>
<span>              </span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt; font-style:normal">
<span>Sets the following fields:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>$</span>
<span style="font-style:italic">pidm</span>
<span> set from $</span>
<span style="font-style:italic">SPRIDEN</span>
<span>_</span>
<span style="font-style:italic">PIDM</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$</span>
<span style="font-style:italic">rollnumber</span>
<span> set from $</span>
<span style="font-style:italic">SPRIDEN</span>
<span>_</span>
<span style="font-style:italic">ID</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Check the Student ID is of the form “@########” and extract the number portion</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$</span>
<span style="font-style:italic">realname</span>
<span> set from $</span>
<span style="font-style:italic">SPRIDEN</span>
<span>_</span>
<span style="font-style:italic">LAST</span>
<span>_</span>
<span style="font-style:italic">NAME</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Replace “.” With space, remove excess whitespace, replace accented characters</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$</span>
<span style="font-style:italic">firstName</span>
<span> set from $</span>
<span style="font-style:italic">SPRIDEN</span>
<span>_</span>
<span style="font-style:italic">FIRST</span>
<span>_</span>
<span style="font-style:italic">NAME</span>
<span> </span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Replace “.” With space, remove excess whitespace, replace accented characters</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$</span>
<span style="font-style:italic">middleName</span>
<span> set from $</span>
<span style="font-style:italic">SPRIDEN</span>
<span>_</span>
<span style="font-style:italic">MI</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Replace “.” With space, remove excess whitespace, replace accented characters</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$</span>
<span style="font-style:italic">preferredname</span>
<span> set from $</span>
<span style="font-style:italic">SPRIDEN</span>
<span>_</span>
<span style="font-style:italic">FIRST</span>
<span>_</span>
<span style="font-style:italic">NAME</span>
<span> </span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$</span>
<span style="font-style:italic">forenames</span>
<span> set from $</span>
<span style="font-style:italic">firstname</span>
<span> $</span>
<span style="font-style:italic">middleName</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$</span>
<span style="font-style:italic">initials</span>
<span> set from $</span>
<span style="font-style:italic">forenames</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Remove apostrophes, uppercase and initilise</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$b_date set from $</span>
<span style="font-style:italic">SPBPERS_BIRTH_DATE</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$title set from  $</span>
<span style="font-style:italic">SPBPERS_NAME_PREFIX</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Remove dots and find AccMan value from </span>
<span style="font-style:italic">$titleMap</span>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt; font-style:italic">
<span>parseCourse()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt; font-style:normal">
<span>Check and convert Course Details from Banner to AccMan equivalents.</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt; font-style:normal">
<span>Rejects the student if:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>student status, SGBSTDN_STST_CODE,  is not one of:</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>AS|IS|DE|IG|RR|SU|WD|WU|IN|WN</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Student level, SGBSTDN_LEVL_CODE, is not one of:</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>UG, PG, FE, PQ, CE</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Student term code, SGBSTDN_TERM_CODE_EFF, is &lt; 2000 or &gt; 2020.</span>
<span style="width:26.04pt; display:inline-block"/>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Student attendance code, SGBSTDN_PROGRAM_1, is not</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>[FSPEDLO]|LI</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Department code, </span>
<span>$SGBSTDN_DEPT_CODE</span>
<span>, is not included in </span>
<span>$depthash</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Department code, </span>
<span>$SGBSTDN_ STYP_CODE</span>
<span>, is not one of:</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>FNCDET</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Year Code, </span>
<span>SGBSTDN_BLCK_CODE, is not 1-9.</span>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt; font-style:normal">
<span>Record any rejections:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>insert into person_rejected_data (importID, rollnumber, field_name, bad_field_value) values (?, ?, ?, ?)</span>
<span>              </span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; line-height:normal; padding-left:4.44pt; font-style:normal">
<span>Sets the following fields:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>$stu_levl set from $SGBSTDN_LEVL_CODE;</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$person_status_code set from $SGBSTDN_LEVL_CODE;</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$stu_term set from $SGBSTDN_TERM_CODE_EFF;</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$acad_sess set from  substr ($SGBSTDN_TERM_CODE_EFF, 0, 4);</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$program set from  $SGBSTDN_PROGRAM_1 || 'X/X/X';</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$stu_att set from  $SGBSTDN_PROGRAM_1 or F</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$sos_code set from  $SGBSTDN_MAJR_CODE_1</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$dept_code set from  $SGBSTDN_DEPT_CODE;</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$stu_styp set from  $SGBSTDN_STYP_CODE;</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$stu_degc set from $SGBSTDN_DEGC_CODE_1;</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$qual_aim_code set from </span>
<span style="font-style:italic">$pgr</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$stu_block set from $SGBSTDN_BLCK_CODE;</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$yr_course set from $SGBSTDN_BLCK_CODE</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$yr_student set from </span>
<span style="font-style:italic">$stu_styp</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$leaver_flag set from '';</span>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<ol start="12" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span style="font-style:italic">parseRegistration()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Check and convert Registration Details to AccMan</span>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt">
<span>Rejects Student if:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Registration status is not one of:</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Y, C, N</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Enrolment Status, </span>
<span>SFBETRM_ESTS_CODE,</span>
<span> is not in $</span>
<span style="font-style:italic">pstate</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Start Date, </span>
<span>SFBETRM_ADD_DATE,</span>
<span> is invalid</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>End date, </span>
<span>SKBHINS_ENDDATE, is invalid</span>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt">
<span>Record any rejections:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>insert into person_rejected_data (importID, rollnumber, field_name, bad_field_value) values (?, ?, ?, ?)</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; line-height:normal; padding-left:4.44pt">
<span>Sets the following fields:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>$reg_status set from $SFBETRM_AR_IND;</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span> $stu_ests set from $SFBETRM_ESTS_CODE;</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$person_state set from $pstate/$SFBETRM_ESTS_CODE/$SKBHINS_ENDDATE</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$start_date set from $SFBETRM_ADD_DATE;</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$end_date set from $SKBHINS_ENDDATE;</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt; font-style:italic">
<span>updateStudentPerson </span>
<span>()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt; font-style:normal">
<span>Check to see if there is an existing Person record by using the StudentID/RollNumber</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>select personID, Initials, RealName, sos_code, person_status_code, dept_code, forenames, qual_aim_code, person_state, importID, yr_student, yr_course, acad_sess, reg_status, leaver_flag, pidm, title, program, stu_term, stu_levl, stu_styp, stu_degc, stu_block, stu_stst, stu_ests, stu_att, start_date, end_date, preferredName, b_date from person where rollnumber = ? and person_status_code in ('N', 'U', 'P', 'X')}</span>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt; font-style:normal">
<span>If the Person record </span>
<span style="font-weight:bold">does not</span>
<span> exist:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Calculate the final year status</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>Via </span>
<span style="font-style:italic">set_Leaver()</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Insert a new Person record</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>insert into person (Initials, RealName, source_code, rollnumber, SPRIDEN_ID, sos_code, person_status_code, dept_code, forenames, qual_aim_code, person_state, importID, first_importID, yr_student, yr_course, acad_sess, reg_status, leaver_flag, pidm, title, program, stu_term, stu_levl, stu_styp, stu_degc, stu_block, stu_stst, stu_ests, stu_att, start_date, end_date, preferredName, b_date) values (?, ?, 'S', ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)</span>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Log the addition of a Person</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span>insert into person_add (importID, rollnumber) values (?, ?)</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:30.43pt; padding-left:5.57pt; font-style:normal">
<span>If the Person record does exist check the data to see if an update is required:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Optionally force an update regardless of data mismatches.</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span style="background-color:#ffff00">don't import 'expected' for following year if 'present' for db year on same programme and yr_course &gt; db_yr_course</span>
<span> </span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Do not update if the new data is for an older academic year.</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>Do not update if new data is older than the current data or worse(!?!)</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span style="background-color:#ffff00">Do not update if the Term Code is </span>
<span style="font-weight:bold; background-color:#ffff00">not</span>
<span style="background-color:#ffff00"> the same in the new and old data, i.e. they have changed course (????) and</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span style="background-color:#ffff00">They were present in the lst course but not present on the new one.</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span style="background-color:#ffff00">Or</span>
</li>
</ol>
</li>
<li style="margin-left:31.35pt; padding-left:4.65pt">
<span style="background-color:#ffff00">The existing aimed for qualification code is less than the new one.</span>
<span style="background-color:#ffff00"> </span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:31.56pt; padding-left:4.44pt; font-style:normal">
<span>Potentially adjust fields:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt; font-style:italic">
<span>$person_state</span>
<ol type="1" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; padding-left:4.65pt; font-style:normal">
<span>Potentially depends on “extended” state of student</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>select personID from extension where personID = ?</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$</span>
<span style="font-style:italic">leaver_flag</span>
</li>
<li style="margin-left:32pt; padding-left:4pt">
<span>$</span>
<span style="font-style:italic">preferredName</span>
</li>
</ol>
</li>
<li style="margin-left:31.25pt; padding-left:4.75pt; font-style:normal">
<span>Log changes.</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">logchange()</span>
</li>
</ol>
</li>
<li style="margin-left:29.13pt; padding-left:6.87pt; font-style:normal">
<span>Update Person record:</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>update person set importID = ?, source_code = 'S', Initials = ?, RealName = ?, SPRIDEN_ID = ?, sos_code = ?, person_status_code = ?, dept_code = ?, forenames = ?, qual_aim_code = ?, person_state = ?, yr_student = ?, yr_course = ?, acad_sess = ?, reg_status = ?, leaver_flag = ?, pidm = ?, title = ?, program = ?, stu_term = ?, stu_levl = ?, stu_styp = ?, stu_degc = ?, stu_block = ?, stu_stst = ?, stu_ests = ?, stu_att = ?, start_date = ?, end_date = ?, preferredName = ?, b_date = ? where personID = ?</span>
</li>
</ol>
</li>
<li style="margin-left:30.95pt; padding-left:5.05pt; font-style:normal">
<span>Add a new Transaction, type 97, to update Janus</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt">
<span>Via </span>
<span style="font-style:italic">generateTransaction()</span>
<span> in </span>
<span style="font-weight:bold">generateTransaction.pl</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt">
<span style="font-style:italic">finishStudentPersonSQL</span>
<span> </span>
<span style="font-style:italic">()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>Closes SQL handles used in the methods described above.</span>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt; font-style:italic">
<span>Set_leaver()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt; font-style:normal">
<span>Read the relevant Leaver flag for the student</span>
<ol type="i" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:32pt; padding-left:4pt; font-style:italic">
<span style="font-style:normal">select p.SPLENGTH, p.UOMS, m.PROGRAM from prog p left join midYearProg m on m.PROGRAM = p.PROGRAM where p.PROGRAM = ?</span>
</li>
</ol>
</li>
</ol>
</li>
<li style="margin-left:36pt; line-height:115%; font-family:Calibri; font-size:11pt; font-style:italic">
<span>Logchange()</span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.43pt; margin-bottom:10pt; padding-left:4.57pt">
<span style="font-style:normal">insert into person_change (importID, personID, field_name, old_field_value, new_field_value) values (?, ?, ?, ?, ?)</span>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; font-size:8pt">
<span style="font-family:Verdana"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<br style="page-break-before:always; clear:both"/>
<a name="_Toc318795948">
<span style="font-family:Cambria; color:#365f91">Other Scripts</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">The following scripts were not initially identified as being crucially important to this analysis but since they do contain references to department names &amp; codes, they are included here</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:14pt">
<span style="font-family:Calibri"> </span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795949">
<span style="font-family:Cambria; color:#365f91">maillist-staff.pl</span>
</a>
</h1>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This is probably not used any more since the last modification was made in 2010. It creates a file containing user details that can be imported into Exchange. We are now using AD/Exchange integration so can’t see this being used. The file it generates includes department details.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:13pt">
<a name="_Toc318795950">
<span style="font-family:Cambria; font-weight:bold; color:#4f81bd">Transactions generated</span>
</a>
<span style="font-family:Calibri; font-size:11pt">: None</span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<span style="font-family:Cambria; color:#365f91"> </span>
</h1>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795951">
<span style="font-family:Cambria; color:#365f91">maillist-student.pl</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Performs the same task as maillist-staff, but for students. </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:13pt">
<a name="_Toc318795952">
<span style="font-family:Cambria; font-weight:bold; color:#4f81bd">Transactions generated</span>
</a>
<span style="font-family:Calibri; font-size:11pt">: None</span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<span style="font-family:Cambria; color:#365f91"> </span>
</h1>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795953">
<span style="font-family:Cambria; color:#365f91">mailstaffchanges.pl</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:13pt">
<a name="_Toc318795954">
<span style="font-family:Cambria; font-weight:bold; color:#4f81bd">Transactions generated</span>
</a>
<span style="font-family:Calibri; font-size:11pt">: None</span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<span style="font-family:Cambria; color:#4f81bd"> </span>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795955">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Compiles a list of staff whose details have changed in the last 24 hours and emails the changes to various people. </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Certain processes (sap_import.pl, studentPerson.pl etc) insert records into the </span>
<span style="font-family:Calibri; font-weight:bold">person_change</span>
<span style="font-family:Calibri"> table to record details that have changed. </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This script looks for changes to the field “dept_code” field and records their old dept_code, and the dept_code of the department they have moved to.</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">select a.username, c.old_field_value as old, d1.dept_name as old_name, c.new_field_value as new, d2.dept_name as new_name, date_format(i.import_time,'%Y-%m-%d') as 'when' </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">from </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    account a </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    join person_change c on a.personID = c.personID </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    join person_import i on c.importID = i.importID, </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    dept d1, </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    dept d2 </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">where </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    i.importID &gt; 12653 </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and i.import_time &gt;= @timescale </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and i.source_code = 'P' </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and c.field_name = 'dept_code' </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and a.state = 'valid' </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and c.old_field_value = d1.dept_code </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and c.new_field_value = d2.dept_code </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">order by a.username, i.importID</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Also reads from the reconciliation table to find people whose username has changed. The reconcile.pl script inserts records into the reconciliation table. The dept_code field is used within the query.</span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">select a.username, p1.dept_code as old, d1.dept_name as old_name, p2.dept_code as new, d2.dept_name as new_name, date_format(r.reconciliation_timestamp, '%Y-%m-%d') as 'when' </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">from </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    account a, </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    person p1, </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    person p2, </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    reconciliation r, </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    dept d1, </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    dept d2 </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">where </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    a.personID = p2.personID </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and p1.rollnumber = r.old_rollnumber </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and p2.rollnumber = r.rollnumber </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and p1.dept_code != p2.dept_code </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and a.state = 'valid' </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and a.status_code = 'S' </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and p1.dept_code = d1.dept_code </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and p2.dept_code = d2.dept_code </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and r.reconciliationID &gt; 3300 </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    and r.reconciliation_timestamp &gt;= @timescale </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">order by a.username, r.reconciliationID</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795956">
<span style="font-family:Cambria; color:#365f91">moverename.pl</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This script is no longer needed. It was switched off during transformation because it does not support AD.</span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<span style="font-family:Cambria; color:#365f91"> </span>
</h1>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795957">
<span style="font-family:Cambria; color:#365f91">noshow.pl</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Looks for students that Accman expected to be here, but who have not turned up. For any students it finds, it re-reads the student details from Banner and updates their details in Accman. This includes department information.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:13pt">
<a name="_Toc318795958">
<span style="font-family:Cambria; font-weight:bold; color:#4f81bd">Transactions generated</span>
</a>
<span style="font-family:Calibri; font-size:11pt">: none</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:14pt">
<span style="font-family:Calibri"> </span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795959">
<span style="font-family:Cambria; color:#365f91">pregen_associate.pl</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:13pt">
<span style="font-family:Cambria; font-weight:bold; color:#4f81bd"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:13pt">
<a name="_Toc318795960">
<span style="font-family:Cambria; font-weight:bold; color:#4f81bd">Transactions generated</span>
</a>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">82 (Complete Associate Generation)</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This script relies heavily on the department details. When a new associate is created, they will write a transaction to the DB with parameters specifying their department code. This script then finds the next available username, from a pool of pre-created accounts, to grant the new user. It then performs an initial setup of the account in NDS. Example:</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Transaction specifies that a user with the following details needs to be created: </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">account_prefix: AAA i.e. what their username should start with </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">department_code: AD i.e. their two-letter department code</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">rollnumber: 400124566 (the user’s rollnumber)</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; text-indent:36pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">status_code: S (staff)</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> This script then reads that transaction and finds the next available matching username (based on the prefix, department, and numeric part of the username. E.g. ‘find the next available username for department code UI, with a prefix UIS’ might come up with 1058 if there have been 1057 members of staff in UIS previously, so the new user will be assigned a username of UIS1058.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">The account is created in an NDS context that is built up using information retrieved from the department_status table (the fields defaultContext, defaultServer and defaultVolume). An example row from the department_status table would be:</span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">SELECT </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    ds.department_status_code, ds.active, ds.defaultContext, ds.defaultServer, ds.defaultvolume </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">FROM department_status ds </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    LEFT OUTER JOIN dept_person_account dpa ON dpa.account_dept_code = ds.dept_code </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">WHERE ds.status_code = ? </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">    AND (dpa.person_dept_code = ? OR ds.dept_code = ?) </span>
</p>
<p style="margin-top:0pt; margin-left:36pt; margin-bottom:0pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">order by department_status_id desc;</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">The parameters to this query are the status code (‘S’ for staff) and the department code (params 2 </span>
<span style="font-family:Calibri; font-style:italic">and</span>
<span style="font-family:Calibri"> 3), all of which come from the transaction parameters.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Once the context has been derived from this query, the user is created in NDS and is forever linked to this department-specific context. </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">NB There is another variant of this script called pregen.pl which is used for non-associates. Pregen.pl is executed independently of user-creation, and is used to create pools of available users that can be used later (still based on departments). Pregen-associate.pl does the same thing, but forms a step in the ‘create associate’ process itself, and instead of creating a pool of e.g. 10 accounts, creates a single account that is snapped up there and then by the user being set up.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:14pt">
<span style="font-family:Calibri"> </span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795961">
<span style="font-family:Cambria; color:#365f91">selfReg.pl</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Transactions Generated: 43 (Register), </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This script is used to manually generate a type 43 (register) transaction for a user. The operator enters the username and the script presents them with some information about the user. It then asks them if the details are correct, and if so, creates the type 43 transaction. </span>
</p>
<p style="margin-top:0pt; margin-bottom:0pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">One of the values displayed to the operator is the user’s department. That seems to be all this script does with the department.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:14pt">
<span style="font-family:Calibri"> </span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795962">
<span style="font-family:Cambria; color:#365f91">staffmultileft.pl</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:13pt">
<span style="font-family:Cambria; font-weight:bold; color:#4f81bd"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:13pt">
<a name="_Toc318795963">
<span style="font-family:Cambria; font-weight:bold; color:#4f81bd">Transactions generated</span>
</a>
<span style="font-family:Calibri; font-size:11pt">: 41 (Reconcile)</span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795964">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This is one of the scripts executed by sap_import.bat. It uses the dept codes in a fairly niche but straightforward way.</span>
</p>
<ol type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; margin-bottom:10pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Looks for all people who are multi-post holders but their person record states that they have ‘left’</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:10pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">select distinct p.personID, a.accID, a.username from person p, account a, person_multi_post m where p.personID = a.personID and p.personID = m.personID_1 and p.multi_post = 'Y' and a.state = 'valid' and a.accountType = 'personal' and p.person_state in ('left', 'absent', 'extended') and p.source_code = 'P'</span>
</p>
<ol start="2" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; margin-bottom:10pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>Count the number of records each person has in the person_multi_post table (to work out how many additional posts they have)</span>
</li>
</ol>
<p style="margin-top:0pt; margin-left:72pt; margin-bottom:10pt; line-height:115%; font-size:8pt">
<span style="font-family:Calibri">select count(m.personID_2) from person_multi_post m, person p where p.personID = m.personID_2 and p.person_state = 'present' and m.personID_1 = ?</span>
</p>
<ol start="3" type="1" style="margin:0pt; padding-left:0pt">
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>If there is only one other account, reconcile it i.e. check what state the second account is in, and if it’s the only account left, make the account record point to this person record (since the previous person record is redundant because it is ‘left’)</span>
</li>
<li style="margin-left:31.35pt; line-height:115%; padding-left:4.65pt; font-family:Calibri; font-size:11pt">
<span>If there are multiple other person records, do a more complicated version of reconcile. This one takes the department code into account i.e. </span>
<ol type="a" style="margin-right:0pt; margin-left:0pt; padding-left:0pt">
<li style="margin-left:31.05pt; padding-left:4.95pt">
<span>if two person records belong to the same </span>
<span style="background-color:#ffff00">department</span>
<span>, try and reconcile them</span>
</li>
<li style="margin-left:31.56pt; margin-bottom:10pt; padding-left:4.44pt">
<span>otherwise try to reconcile them another way (i.e. disable the extra account)</span>
</li>
</ol>
</li>
</ol>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:14pt">
<span style="font-family:Calibri"> </span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795965">
<span style="font-family:Cambria; color:#365f91">staffsequential.pl</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:13pt">
<a name="_Toc318795966">
<span style="font-family:Cambria; font-weight:bold; color:#4f81bd">Transactions generated</span>
</a>
<span style="font-family:Calibri; font-size:11pt">: 41 (Reconcile)</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This is one of the scripts executed by sap_import.bat. It’s almost identical to staffmultileft.pl apart from the fact that it acts on people who do not have multiple posts. It also uses the </span>
<span style="font-family:Calibri; background-color:#ffff00">department</span>
<span style="font-family:Calibri"> code in a fairly minor way.</span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<br style="page-break-before:always; clear:both"/>
<a name="_Toc318795967">
<span style="font-family:Cambria; color:#365f91">Register.pl</span>
</a>
</h1>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795968">
<span style="font-family:Cambria; color:#4f81bd">Introduction</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<a name="_Toc318795969">
<span style="font-family:Calibri; font-weight:normal">Applies account settings from student account assignment and staff self-registration.</span>
</a>
<span style="font-family:Calibri; font-weight:normal"> </span>
</h2>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:11pt">
<a name="_Toc318795970">
<span style="font-family:Calibri; font-weight:normal">Links an account record to its person record &amp; many other things such as setting up email, setting quotas etc</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Contains a lot of NDS functionality that will be (has been) phased out after transformation</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Takes 4 transaction parameters: accID, personID, username and disabledReason (optional)</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Since it performs many different tasks, and it quite often breaks half way through doing these things, the register process keeps track of where it is using a fifth transaction parameter called trState. Each time a step is completed, this number is incremented up to the current final state of 24. Until this state is reached, the tr_state of the transaction remains at ‘pending’, and on reaching state 24, it is changed to ‘processed’.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This allows the register script to ‘recover’ any half-processed transactions that would otherwise have failed and been left in a state of limbo. It looks for any ‘pending’ transactions, checks what state they reached before the script encountered a problem, and then continues from where it left off.</span>
</p>
<h2 style="margin-top:10pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:13pt">
<a name="_Toc318795971">
<span style="font-family:Cambria; color:#4f81bd">Process</span>
</a>
</h2>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 0: links the account and person records together by setting the personID column in the account table</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 1: Get the default email system by calling getDefaultDisposeDomain().</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 2: Generate a random email password and insert it into the account_details table (for the EMAIL system)</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 3: Create a mail account by calling createMailAccount() from mailAccount.pl. This inserts a record into mail_account table in the IDM database.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 4: Generates the email address which takes the form of the initials followed by the surname (with some checking and formatting). Works out their domain (e.g. salford.ac.uk or live.salford.ac.uk) based on whether they are staff or student. Adds the primary and alias addresses to the account.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 5: Generates a random password for Athens and inserts it into the account_details table</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 6: Insert a new transaction to create the Athens account (type 7)</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 7: Insert a new transaction to create the password.txt file in the user’s F: drive (type 39)</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 8: Set the property ‘NetAPPIMAPhomeDirectory’ on the users NDS account (students only)</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 9: Set the email quota by updating the account_details table (where type = ‘EMAIL’)</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 10: Set the GPAS Balance (obsolete) for printing</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 11: Set the NDS file quota by updating the account_details table (where type = @NDS’)</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 12: Remove the account expiry date from NDS</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 13: Sets some more NDS attributes (username, rollnumber, name).</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 14: Sets the ACLs in NDS so that the user cannot change the rollnumber and lastname attributes.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 15: Create the import and control files for the NDS account, and then run JRBImprt to set all the relevant values for this user.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 16: Update the account so that it is valid.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 17: Disable the account if there is a disabled reason associated with the account</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 18: Update the mail account (calls updateMailAccount()) to update table mail_account in the IDM database.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 19: A type 42 (set email quota) transaction used to be generated here, but it doesn’t happen any more.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 20: Insert a transaction to create the Live@Edu account for students (type 48).</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 21: Update the account table with some email-related values</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 22: Insert a transaction to create a new Janus account (type 97)</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 23: Insert a transaction to create the AD account (type  93)</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">State 24: Finished!</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<br style="page-break-before:always; clear:both"/>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795972">
<span style="font-family:Cambria; color:#365f91">.NET Processes</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">The following .NET processors in AccmanBackEndLibrary make use of the department. The classes (processors) in AccmanBackEndLibrary are roughly equivalent to the older Perl scripts.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri; font-weight:bold"> </span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795973">
<span style="font-family:Cambria; color:#365f91">TempusCohortCreateUpdateUser</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This has its own list of departments which reside in a different database. A new table in Accman called TempusCohortProgrammes contains references to these departments.</span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795974">
<span style="font-family:Cambria; color:#365f91">ActivateDirectoryNewUser</span>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">This makes use of the department code stored in HR_DEPARTMENTS and if a matching one cannot be found, it will fall back to using the department in the dept table. The department name is pushed into ActiveDirectory.</span>
</p>
<h1 style="margin-top:24pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; line-height:115%; font-size:14pt">
<a name="_Toc318795975">
<span style="font-family:Cambria; color:#365f91">ImportAssociate</span>
<span style="-aw-bookmark-end:_Toc318707474"/>
</a>
</h1>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri">Reads the department code from the Associates database (in the Associate.DepartmentCode column) and inserts it into person.dept_code column in the Mail database.</span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:14pt">
<span style="font-family:Calibri"> </span>
</p>
<p style="margin-top:0pt; margin-bottom:10pt; line-height:115%; font-size:11pt">
<span style="font-family:Calibri"> </span>
</p>
</div>
    </div>
</div>
</p>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/16384034/16581310.docx">Full Accman Analysis_RGandMM_2012_03_02 (2).docx</a> (application/vnd.openxmlformats-officedocument.wordprocessingml.document)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Mar 29, 2021 10:56</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
