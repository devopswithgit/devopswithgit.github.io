<!DOCTYPE html>
<html>
    <head>
        <title>Accman Refresh : Accman Refresh: Completed</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Accman Refresh</a></span>
                            </li>
                                                    <li>
                                <span><a href="Accman-Refresh-Home_17170433.html">Accman Refresh Home</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Accman Refresh : Accman Refresh: Completed
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (ais008)</span>, last modified by <span class='editor'> Unknown User (ujs079)</span> on Apr 10, 2015
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p>Area for future development ideas, documentation snippets, comments on existing system features and ideas for improvements. </p><h1 id="AccmanRefresh:Completed-ProgressTracking">Progress Tracking</h1><p>AccMan Refresh WIP information can be viewed using the JIRA plugin Structure, where the script name is used as the issue summary.  As each script is converted from Perl to .NET estimated and actual time taken is updated. The path to the Accman Refresh Structure page is: <a href="http://uos-d-dbld-01.isdads.salford.ac.uk:8080/jira/secure/StructureBoard.jspa" class="external-link" rel="nofollow">http://uos-d-dbld-01.isdads.salford.ac.uk:8080/jira/secure/StructureBoard.jspa</a></p><h1 id="AccmanRefresh:Completed-Scripts">Scripts</h1><ul><li>The current active scripts are written in three languages, Perl, PowerShell and VB Script.</li><li>The scripts were categorized by type and function to split into workable chunks:</li></ul><div class="table-wrap"><table style="margin-left: 30.0px;" class="confluenceTable"><tbody style="margin-left: 30.0px;"><tr style="margin-left: 30.0px;"><th style="margin-left: 30.0px;" class="confluenceTh">Language</th><th style="margin-left: 30.0px;" class="confluenceTh">Amount</th><th colspan="1" style="margin-left: 30.0px;" class="confluenceTh">Category</th></tr><tr style="margin-left: 30.0px;"><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">Perl</td><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">12</td><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">Shared Library</td></tr><tr style="margin-left: 30.0px;"><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">Perl</td><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">17</td><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">Real-time Transactions</td></tr><tr style="margin-left: 30.0px;"><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd"><span>Perl</span></td><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">26</td><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd"><p>Batch Jobs:</p><ul><li><span style="line-height: 1.4285715;">Banner</span></li><li>SAP</li></ul></td></tr><tr style="margin-left: 30.0px;"><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">PowerShell</td><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">3</td><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">ADMO</td></tr><tr style="margin-left: 30.0px;"><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd"><span>PowerShell</span></td><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">5</td><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">Office 365 Processor</td></tr><tr style="margin-left: 30.0px;"><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">VB Script</td><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">1</td><td colspan="1" style="margin-left: 30.0px;" class="confluenceTd">SalSync (Mike Hall)</td></tr></tbody></table></div><ul><li>Transaction scripts are invoked by the Go.bat command script which in turn calls each of the Perl Real-time transactions.</li><li>Batch scripts are triggers from Windows scheduled jobs either individually or grouped in sequence using a command script. </li></ul><p> </p><p>Scripts completed so far:</p><p style="margin-left: 30.0px;"><strong>/scheduled<br/></strong></p><p style="margin-left: 60.0px;"><s>alignMailAccount.pl</s> - <span style="color: rgb(153,204,0);">MA: done</span><br/><s>allocateNew.pl</s> - <span style="color: rgb(153,204,0);">MA: done</span><br/><s>deduplicateWeekly.pl</s> - <span style="color: rgb(255,0,0);">MA/AB: excluded</span><br/><s>DIDtidy.pl</s> – <span style="color: rgb(255,102,0);">MA/AB: may not be needed (although active)</span><br/>emailbackfill.pl - <span style="color: rgb(153,204,0);">MA: done</span><br/><span style="line-height: 1.4285715;">emailtotal.pl - <span style="color: rgb(153,204,0);">MA: done</span><br/></span>expirealias.pl - <span style="color: rgb(153,204,0);">MA: done</span><br/>extendDaily.pl - <span style="color: rgb(153,204,0);">MA: done</span><br/><span style="line-height: 1.4285715;"><s>maillist-staff.pl</s> – <span style="color: rgb(255,0,0);">AB: excluded</span><br/></span><s>maillist-student.pl</s> – <span style="color: rgb(255,0,0);">AB: excluded</span><br/><s>mailstaffchanges.pl</s> – <span style="color: rgb(255,0,0);">AB: excluded</span><br/><span style="line-height: 1.4285715;">sap_exportemail.pl -<span style="color: rgb(153,204,0);"> MA: done</span><br/></span>sap_import.pl – <span style="color: rgb(153,204,0);">VP: WIP</span><br/>staffautostate.pl - <span style="color: rgb(153,204,0);">MA: done</span><br/>staffmultileft.pl - <span style="color: rgb(153,204,0);">MA</span><span style="color: rgb(153,204,0);">: done</span><br/><span style="line-height: 1.4285715;">staffmultipost.pl - <span style="color: rgb(153,204,0);">MA: done</span><br/></span>staffsequential.pl - <span style="color: rgb(153,204,0);">MA</span><span style="color: rgb(153,204,0);">: done</span><br/><br/><span style="line-height: 1.4285715;"><strong>/sisimport</strong><br/></span></p><p style="margin-left: 90.0px;"><s>banner4address.pl</s> – <span style="color: rgb(153,204,0);">M</span><span style="color: rgb(153,204,0);">J: done</span><br/><span style="line-height: 1.4285715;"><s>banner4ftp.pl</s> – <span style="color: rgb(255,0,0);">AB: <span style="color: rgb(255,0,0);">excluded</span></span><br/></span>banner4import.pl – <span style="color: rgb(153,204,0);">AEJ : done</span><br/>banner4person.pl - <span style="color: rgb(153,204,0);">AEJ : done</span><br/>banner4prog.pl - <span style="color: rgb(153,204,0);">AEJ : done</span><br/><s>banner4talis.pl</s> – <span style="color: rgb(255,0,0);">AB: <span style="color: rgb(255,0,0);">excluded</span></span><br/>noshow.pl -  <span style="color: rgb(153,204,0);">AEJ : done</span><br/>restoreUFAA.pl - <span style="color: rgb(153,204,0);">AEJ : done</span><br/>studentautostate.pl -<span style="color: rgb(153,204,0);"> MA: done</span></p><h1 id="AccmanRefresh:Completed-Documentation">Documentation</h1><ul><li><a href="https://confluence.salford.ac.uk:8444/confluence/display/AC/Accman+Rewrite+Documentation+2013">Accman Rewrite Documentation 2013</a> - Complete Accman documentation.</li><li><a href="https://confluence.salford.ac.uk:8444/confluence/display/AC/Perl+Script+Analysis">Perl Script Analysis</a> - Full analysis of all Accman Realtime Transactions (Micosoft Word Attachment).</li><li><a href="https://confluence.salford.ac.uk:8444/confluence/display/AC/AD+Sync+Script+Rewrite">AD Sync Script Rewrite</a> - Analysis of the Mike Hall and ADMO scripts. </li></ul><h1 id="AccmanRefresh:Completed-SourceControl">Source Control</h1><ul><li>The full source for the Accnan .Net code is available in subversion repository branch &quot;AccmanRefresh&quot;:<br/><a href="https://uos-d-dbld-01/svn/SalfordDevelopment/.NET/Accman.NET/branches/AccmanRefresh" style="line-height: 1.4285715;" class="external-link" rel="nofollow">https://uos-d-dbld-01/svn/SalfordDevelopment/.NET/Accman.NET/branches/AccmanRefresh<br/> </a></li><li>The Perl, PowerShell and VB script code is available in a sub-folder named 'Scripts' when the branch is downloaded. The list below describes </li></ul><div class="table-wrap"><table style="margin-left: 30.0px;" class="confluenceTable"><tbody style="margin-left: 30.0px;"><tr style="margin-left: 30.0px;"><th class="confluenceTh">Folder</th><th class="confluenceTh">Description</th></tr><tr style="margin-left: 30.0px;"><td class="confluenceTd">Scripts/Accman.Perl.Komodo</td><td class="confluenceTd">The Perl source project used in ActiveState's Komodo IDE, it contains the Shared Library, Real-time and Batch scripts.</td></tr><tr style="margin-left: 30.0px;"><td colspan="1" class="confluenceTd">Scripts/Accman.PowerShell.ADMO</td><td colspan="1" class="confluenceTd">ADMO PoweShell Scripts, used to set User, Group in Active Directory and Exchange.</td></tr><tr style="margin-left: 30.0px;"><td colspan="1" class="confluenceTd"><span>Scripts/</span><span>Accman.PowerShell.O365</span></td><td colspan="1" class="confluenceTd">Office 365 server side scripts.</td></tr><tr style="margin-left: 30.0px;"><td colspan="1" class="confluenceTd"><span>Scripts/</span>Accman.VisulBasic.SalSync</td><td colspan="1" class="confluenceTd">The Mike Hall VB script.</td></tr></tbody></table></div><h1 id="AccmanRefresh:Completed-Development">Development</h1><p>The .Net Accman.Net solution relies on .net Framework version 4 and the following external libraries:</p><ol><li>Quartz.Net v1.0.3.3 - Used by the Console Scheduler Service to invoke jobs/transactions at defined intervals using CRON notation configured in the XML job definition. </li><li>Common.Logging.Log4Net v 2.0.0.0 - Provides logging capabilities to Accman.Net</li><li>MySQL and Oracle database connectors.</li></ol><h3 id="AccmanRefresh:Completed-Perl">Perl</h3><p>The '<span>Accman.Perl.Komodo' folder contains the project file 'AccMan.komodoproject' which can be opened by ActiveState's Komodo IDE. It is used in this project because it provides IDE features familiar to Visual Studio uses and makes code navigation/tracing easier.</span></p><p><span><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-thumbnail" width="300" src="attachments/17170437/17301509.jpg" data-image-src="attachments/17170437/17301509.jpg" data-unresolved-comment-count="0" data-linked-resource-id="17301509" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="komodoIDE.jpg" data-base-url="https://confluence.salford.ac.uk:8444/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="17170437" data-linked-resource-container-version="62"></span><br/></span></p><p>To test portions of Perl script the ActiveState's ActivePerl framework is required. It contains the interpreter and libraries as well as utilities like the package manager. The package manager is used to download and install libraries not included with the ActivePerl installation. Scripts can be created and run generate output which can be compared to that generated by .Net code to ensure both sets of code produce the same results. To invoke a Perl script (provided ActivePerl and necessary libraries are installed) open a command prompt and type 'perl' followed by the script path, then hit the Enter key to execute:</p><p> </p><p>Additional libraries used for testing are:</p><ul><li>String-MkPassword - a third party library for generating random passwords.</li></ul><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-thumbnail" width="300" src="attachments/17170437/17301508.jpg" data-image-src="attachments/17170437/17301508.jpg" data-unresolved-comment-count="0" data-linked-resource-id="17301508" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="commandPerl.jpg" data-base-url="https://confluence.salford.ac.uk:8444/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="17170437" data-linked-resource-container-version="62"></span></p><h3 id="AccmanRefresh:Completed-DatabaseConnectivity">Database Connectivity</h3><ul><li>The Accman solution uses both MySQL and Oracle platforms. To test queries and view data, their respective IDE environments and client connectors need to be installed locally:<ul><li>MySQL Workbench - An IDE environment to use with the Accman Mail and IDM databases.</li><li>Oracle Client 11g - For oracle connectivity to the Banner database also used in Accman.</li><li> Toad - An IDE environment to use with the Banner database.</li></ul></li><li><p>The connection settings for each database can be configure in the Quartz job definitions:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Connection Strings</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: xml; gutter: true; first-line: 1; theme: Confluence" data-theme="Confluence">&lt;entry&gt;
  &lt;key&gt;AccManDatabase&lt;/key&gt;
  &lt;value&gt;Server=uos-t-rhel-03.isdads.salford.ac.uk;Uid=accman;Pwd=w3w2g,wnam!;Database=mail;&lt;/value&gt;
&lt;/entry&gt;
&lt;entry&gt;
  &lt;key&gt;BannerDatabase&lt;/key&gt;
  &lt;value&gt;Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=uos-d-rhel-05.isdads.salford.ac.uk)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=DBANO1.salford.ac.uk)));User Id=salford;Password=who_done_it;&lt;/value&gt;
&lt;/entry&gt;</pre>
</div></div></li></ul><p><br class="_mce_tagged_br"/><br/></p><p> </p><p> </p>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/17170437/17301509.jpg">komodoIDE.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/17170437/17301508.jpg">commandPerl.jpg</a> (image/jpeg)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Mar 29, 2021 11:13</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
